var P5g=function(e){function t(e,t){if(isFinite(e)&&isFinite(t)&&e>=0&&b>e&&t>=0&&v>t){var a=e+t*b;k?void 0===p?r():o(p):0===y[a]?(y[a]=x,E[x-1]=a,n(),x+=1,x>f&&(k=!0)):console.log("Unavailable placement.")}else console.log("Unavailable placement.")}function n(){if(x>f)r();else{for(var e={},t={},n={},a={},i=0;x>i;i++){for(var l=E[i],c=l%b,d=(l-c)/b,s={},p={},h=0;h<G.length;h++){var u,g,k=G[h],w=q[k],N=[m];s[k]=[],p[k]=[],1===w.x?N.push(b-c):-1===w.x&&N.push(c+1),1===w.y?N.push(v-d):-1===w.y&&N.push(d+1),g=Math.min.apply(null,N);for(var F=1;g>F;F++){if(u=l+(w.x+w.y*b)*F,y[u]<=0){if(p[k].length)break;p[k].push(F);break}if(0!==(y[u]-y[l]&1))break;s[k].push(u)}}var L=Array(K.length);for(h=0;h<K.length;h++){var U=K[h],D=Q[h];L[h]={keys:U+"-"+D,oc:0,ar:s[U].concat(l).concat(s[D])},p[U].length||L[h].oc++,p[D].length||L[h].oc++}var R,A="",_=0;for(h=0;h<L.length;h++)_=L[h].ar.length,A=L[h].ar.join(";"),R=L[h].oc,m>_||e.hasOwnProperty(A)?_!==m-1||t.hasOwnProperty(A)?_!==m-2||a.hasOwnProperty(A)||0!==R||(a[A]=x):1===R?n[A]=x:0===R&&(t[A]=x):e[A]=x}C.push(new Uint16Array(f));var O=Object.keys(e),M=Object.keys(t),P=Object.keys(n),B=Object.keys(a),I=[],j=C[C.length-1];for(i=0;i<O.length;i++)I=O[i].split(";"),I.forEach(function(e){j[e]=I.length});for(i=0;i<M.length;i++)I=M[i].split(";"),I.forEach(function(e){j[e]<m-1&&(j[e]=I.length)});for(i=0;i<P.length;i++)I=P[i].split(";"),I.forEach(function(e){j[e]<m-1&&(j[e]=I.length)});for(i=0;i<B.length;i++)I=B[i].split(";"),I.forEach(function(e){j[e]<m-2&&(j[e]=I.length)});O.length?o((x-1)%2):x===f&&r()}}function o(e){k=!0,p=e,console.log("Player",e+1,"wins.")}function r(){k=!0,console.log("Tie")}function a(){return JSON.stringify({w:b,h:v,d:Array.prototype.slice.call(E,0,x-1)})}function i(e){try{var n=JSON.parse(e);l(n.w,n.h);for(var o=0;o<n.d.length;o++){var r=n.d[o]%n.w,a=(n.d[o]-r)/n.w;t(r,a)}}catch(i){console.log(i)}}function l(e,t){e=isFinite(e)?+e:u,t=isFinite(t)?+t:g,b=m+2>e?m+2:e>256?256:e,v=m+2>t?m+2:t>256?256:t,f=b*v,y=new Uint16Array(f),E=new Uint16Array(f),x=1,C=[],k=!1}function c(){for(var e=document.getElementsByClassName("point"),t=0;t<e.length;t++){var n=e[t].dataset.p;y[n]&&(e[n].className=e[n].className.substr(0,12)+" p"+((y[n]-1)%2+1),e[n].title=y[n],e[n].removeEventListener("click",d)),e[t].firstChild.className=C[C.length-1][n]>0?"cir c"+Math.min(C[C.length-1][n],5):"cir",k&&(e[t].removeEventListener("click",d),e[t].className="point"+e[t].className.substr(12))}k&&alert(void 0===p?"It`s a tie.":"Player "+(p+1)+" wins."),document.getElementById("gsc_"+h).innerHTML=".point.active { background-color: "+((x-1)%2?"#E6E6FF":"#FFE6E6")+";}"}function d(e){if(0===e.button){e.preventDefault(),this.removeEventListener("click",d),this.className=this.className.substr(0,12)+" p"+((x-1)%2+1),this.title=x,t(+this.dataset.x,+this.dataset.y);for(var n=document.getElementsByClassName("point"),o=0;o<n.length;o++){var r=n[o].dataset.p;n[o].firstChild.className=C[C.length-1][r]>0?"cir c"+Math.min(C[C.length-1][r],5):"cir",k&&(n[o].removeEventListener("click",d),n[o].className="point"+n[o].className.substr(12))}document.getElementById("gsc_"+h).innerHTML=".point.active { background-color: "+((x-1)%2?"#E6E6FF":"#FFE6E6")+";}",k&&alert(void 0===p?"It`s a tie.":"Player "+(p+1)+" wins.")}}function s(e,t,n){var o=document.createElement("div"),r=document.createElement("style"),a=document.createElement("style"),i=document.getElementById("gs_"+h),c=document.getElementById("gsc_"+h),s=document.getElementById("dg_"+h);s&&s.parentNode.removeChild(s),i&&i.parentNode.removeChild(i),c&&c.parentNode.removeChild(c),l(t,n),o.id="dg_"+h,r.id="gs_"+h,a.id="gsc_"+h,r.innerHTML="#dg_"+h+" { width: "+22*b+"px; height: "+22*v+"px; display: inline-block; box-sizing: border-box; } .point { background-color: #EEE; width: 20px; height: 20px; float: left; line-height: 20px; font-size: 12px; text-align: center; padding: 1px; position: relative; overflow: hidden; } .point > .cir { width: 20px; height: 20px; border-radius: 10px; z-index: 10; position: absolute; top: 1px; left: 1px; } .point.active>.cir:hover { background-color: #FFF; cursor: pointer; } .p1 > .cir,.p1.active > .cir:hover { background-color: #E6A1A1; cursor: default; box-shadow: inset 0 0 10px rgba(200, 40, 40, 0.6); } .p2 > .cir,.p2.active > .cir:hover { background-color: #A1A1E6; cursor: default; box-shadow: inset 0 0 10px rgba(40, 40, 200, 0.6); } .bo { display: none; position: absolute; width: 15px; height: 15px; box-shadow: inset 0 0 2px #111; } .l1 { display: block; top: -4px; left: -4px; } .l2 { display: block; top: -4px; right: -4px; } .l3 { display: block; bottom: -4px; left: -4px; } .l4 { display: block; bottom: -4px; right: -4px; } .p1 > .cir.c3 { background-color: #E65C5C; } .p1 > .cir.c4 { background-color: #E62E2E; } .p1 > .cir.c5 { background-color: #FE0101; } .p2 > .cir.c3 { background-color: #5C5CE6; } .p2 > .cir.c4 { background-color: #2E2EE6; } .p2 > .cir.c5 { background-color: #0101FE; }",a.innerHTML=".point.active { background-color: "+((x-1)%2?"#E6E6FF":"#FFE6E6")+";}";for(var p=0;v>p;p++){for(var m=document.createElement("div"),u=0;b>u;u++){var g=document.createElement("div");g.dataset.p=u+p*b,g.className="point active",g.dataset.x=u,g.dataset.y=p,g.addEventListener("click",d),g.appendChild(document.createElement("div")),g.firstChild.className="cir",g.appendChild(document.createElement("div")),g.lastChild.className="bo"+(0===u||0===p?"":" l1"),g.appendChild(document.createElement("div")),g.lastChild.className="bo"+(u===b-1||0===p?"":" l2"),g.appendChild(document.createElement("div")),g.lastChild.className="bo"+(0===u||p===v-1?"":" l3"),g.appendChild(document.createElement("div")),g.lastChild.className="bo"+(u===b-1||p===v-1?"":" l4"),m.appendChild(g)}m.appendChild(document.createElement("div")),m.lastChild.style.clear="both",o.appendChild(m)}e?e.appendChild(o):document.body.appendChild(o),document.body.appendChild(r),document.body.appendChild(a)}e=void 0===e?{}:{oldP5g:e};var p,h=Math.round(1e7*Math.random()),m=5,u=32,g=32,b=u,v=g,f=b*v,y=new Uint16Array(f),E=new Uint16Array(f),x=1,k=!1,C=[],w=8,N=4,F=2,L=1,U=32768,D=16384,R=8192,A=4096,_=2048,O=1024,M=512,P=256,B=128,I=64,j=32,T=16,H=8,z=4,J=2,S=1,q={U:{d:w,m:U,b:B,x:0,y:-1},UR:{d:w|N,m:D,b:I,x:1,y:-1},R:{d:N,m:R,b:j,x:1,y:0},RD:{d:N|F,m:A,b:T,x:1,y:1},D:{d:F,m:_,b:H,x:0,y:1},DL:{d:F|L,m:O,b:z,x:-1,y:1},L:{d:L,m:M,b:J,x:-1,y:0},LU:{d:L|w,m:P,b:S,x:-1,y:-1}},G=Object.keys(q),K=["LU","L","UR","U"],Q=["RD","R","DL","D"];return q.U.r=q.D,q.UR.r=q.DL,q.R.r=q.L,q.RD.r=q.LU,q.D.r=q.U,q.DL.r=q.UR,q.L.r=q.R,q.LU.r=q.RD,e.hist=function(){return E},e.map=function(){return y},e.pat=function(){return C},e.place=t,e.reset=l,e.save=a,e.load=i,e.refresh_dom=c,e.create_dom=s,e}(P5g);