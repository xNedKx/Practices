function factorial(n){var m=1;if(n>0){n=parseInt(n);do m*=n;while(--n)}return m}function combinationF(n,m){return m>n?0:factorial(n)/(factorial(m)*factorial(n-m))}function combination(n,m){if(n>=m&&n>0&&m>0){var t,s;n=parseInt(n),m=parseInt(m),t=1,s=1,m=2*m>n?n-m:m;for(var e=0;m>e;e++)t*=n,n--;for(;m>0;)s*=m,m--;return t/s}return 0}function permutation(n,m){if(n>=m&&n>0&&m>0){var t=1;n=parseInt(n),m=parseInt(m);for(var s=0;m>s;s++)t*=n,n--;return t}return 0}function cn(n,m){var t=[],s=0,e=[];for(t[0]=0;t[0]<n.length-m+1;t[0]++)if(e[0]=n[t[0]],1==m)s+=e[0];else for(t[1]=t[0]+1;t[1]<n.length-m+2;t[1]++)if(e[1]=e[0]*n[t[1]],2==m)s+=e[1];else for(t[2]=t[1]+1;t[2]<n.length-m+3;t[2]++)if(e[2]=e[1]*n[t[2]],3==m)s+=e[2];else for(t[3]=t[2]+1;t[3]<n.length-m+4;t[3]++)if(e[3]=e[2]*n[t[3]],4==m)s+=e[3];else for(t[4]=t[3]+1;t[4]<n.length-m+3;t[4]++)e[4]=e[3]*n[t[4]],s+=e[4];return s}function card(n,m){return types[n]&&(m=parseInt(m))>0&&14>m&&2==arguments.length?(this.type=n,this.number=m,this.name=4==n?1==m?"Red":"Black":2>m?"A":11>m?""+m:12>m?"J":13>m?"Q":"K",this.typeName=types[n],this.show=function(){var n=this.typeName+" "+this.name;return console.log(n),n},new arguments.callee(n,m,1)):types[n]&&(m=parseInt(m))>0&&14>m&&3==arguments.length&&arguments[2]?(this.type=n,this.number=m,this.name=4==n?1==m?"Red":"Black":2>m?"A":11>m?""+m:12>m?"J":13>m?"Q":"K",this.typeName=types[n],this.show=function(){var n=this.typeName+" "+this.name;return console.log(n),n},!0):null}function rank(n,m){if(5==n.length){var m=1==arguments.length?check5(n).rank:m,n=1==arguments.length?check5(n).toArray():n;this.rank=m,this.show=function(){for(var t=rules[m]+": ",s=0;s<n.length;s++)t+=n[s].typeName+" "+n[s].name+(s<n.length-1?" , ":"");return console.log(t),t},this.toArray=function(){return n},this.comp=function(t){var s=t.toArray();if(5==n.length&&5==s.length){if(m>t.rank)return!0;if(m<t.rank)return!1;switch(m){case 0:for(var e=0;5>e;e++){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null;case 1:for(var e=0;5>e;e++)if(1!=e){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null;case 2:for(var e=0;5>e;e++)if(1!=e&&3!=e){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null;case 3:for(var e=0;5>e;e++)if(1!=e&&2!=e){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null;case 4:for(var e=0;5>e;e++){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null;case 5:for(var e=0;5>e;e++){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null;case 6:for(var e=0;5>e;e++)if(1!=e&&2!=e&&4!=e){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null;case 7:for(var e=0;5>e;e++)if(1!=e&&2!=e&&3!=e){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null;case 8:for(var e=0;5>e;e++){if(n[e].number>s[e].number)return!0;if(n[e].number<s[e].number)return!1}return null}}}}}function hand(n){function m(n){n=e(n);for(var m=0;m<n.length;m++)m>0&&n[m].type==n[m-1].type&&n[m].number==n[m-1].number&&n.splice(m,1);return n}function t(){for(var n=[];n.length<5;)n.push(new card(Math.floor(4*Math.random()),Math.floor(13*Math.random())+1)),m(n);return n}function s(n){for(var m=0,t=0,s=0,e=0,r=0;r<n.length;r++)switch(n[r].type){case 0:n.unshift(n.splice(r,1)[0]),m++,t++,s++,e++;break;case 1:n.splice(m,0,n.splice(r,1)[0]),t++,s++,e++;break;case 2:n.splice(t,0,n.splice(r,1)[0]),s++,e++;break;case 3:n.splice(s,0,n.splice(r,1)[0]),e++;break;case 4:n.push(n.splice(r,1)[0]);break;default:return null}for(var a=0;a<n.length;a++)if(m>a)for(var o=a;o>0;o--)n[o].number<n[o-1].number&&n.splice(o-1,0,n.splice(o,1)[0]);else if(t>a)for(o=a;o>m;o--)n[o].number<n[o-1].number&&n.splice(o-1,0,n.splice(o,1)[0]);else if(s>a)for(o=a;o>t;o--)n[o].number<n[o-1].number&&n.splice(o-1,0,n.splice(o,1)[0]);else if(e>a)for(o=a;o>s;o--)n[o].number<n[o-1].number&&n.splice(o-1,0,n.splice(o,1)[0]);return n}function e(n){n:for(var m=0;m<n.length;m++)for(var t=m;t>0;t--)if(n[t].number<n[t-1].number||n[t].number==n[t-1].number&&n[t].type<n[t-1].type)n.splice(t-1,0,n.splice(t,1)[0]);else if(arguments[1]&&n[t].number==n[t-1].number&&n[t].type==n[t-1].type){n.splice(t-1,1),m--;continue n}return n}function r(n){for(var m=n.length;m>0;m--)n.push(n.splice(Math.floor(Math.random()*m),1)[0]);return n}function a(n){if(5==n.length){var m,t={p:0,k3:!1,k4:!1,s:!0,f:!0,pn:[],k3n:0,k4n:0,o:[],h:[]},s={t:[],n:{}},r=1,a={};n=e(n);for(var o=0;5>o;o++)if(s.t[n[o].type]?s.t[n[o].type]++:s.t[n[o].type]=1,s.n[n[o].number]?s.n[n[o].number]++:s.n[n[o].number]=1,o>0&&n[o].number==n[o-1].number){if(t.s=!1,t.f=!1,r++,4==o)switch(r){case 2:t.p++,t.pn.push(n[o].number),t.k3?(t.h.push(n[o-1]),t.h.push(n[o])):(t.h.unshift(n[o]),t.h.unshift(n[o-1]));break;case 3:t.k3=!0,t.k3n=n[o].number,t.h.unshift(n[o]),t.h.unshift(n[o-1]),t.h.unshift(n[o-2]);break;case 4:t.k4=!0,t.k4n=n[o].number,t.h.unshift(n[o]),t.h.unshift(n[o-1]),t.h.unshift(n[o-2]),t.h.unshift(n[o-3])}}else{switch(r){case 1:t.s&&(n[o].number==n[0].number+o||1==n[0].number&&n[o].number==9+o||(t.s=!1)),o>0&&t.o.unshift(n[o-1]);break;case 2:t.p++,t.pn.push(n[o-1].number),t.k3?(t.h.push(n[o-2]),t.h.push(n[o-1])):(t.h.unshift(n[o-1]),t.h.unshift(n[o-2]));break;case 3:t.k3=!0,t.k3n=n[o-1].number,t.h.unshift(n[o-1]),t.h.unshift(n[o-2]),t.h.unshift(n[o-3]);break;case 4:t.k4=!0,t.k4n=n[o-1].number,t.h.unshift(n[o-1]),t.h.unshift(n[o-2]),t.h.unshift(n[o-3]),t.h.unshift(n[o-4])}r=1,4==o&&t.o.unshift(n[o])}t.o.length>0&&1==t.o[t.o.length-1].number&&(t.s&&2!=t.o[t.o.length-2].number||!t.s)&&t.o.unshift(t.o.pop()),2==t.p&&1==t.h[t.h.length-1].number&&(t.h.unshift(t.h.pop()),t.h.unshift(t.h.pop())),a=t.h.concat(t.o),t.f&&s.t.length>1&&(t.f=0),m=t.s&&t.f?8:t.k4?7:t.k3&&t.p?6:t.f?5:t.s?4:t.k3?3:2==t.p?2:t.p?1:0}return new rank(a,m)}function o(){for(var n=0;n<i.length;n++)i[n].number&&i[n].name&&i[n].typeName&&i[n].show&&i[n].number>0&&i[n].number<14&&types[i[n].type]||(i.splice(n,1),n--)}var i=[];if(this.toArray=function(){return i},this.length=i.length,this.show=function(){for(var n="",m=0;m<i.length;m++)n+=i[m].typeName+" "+i[m].name+(m<i.length-1?" , ":"");return console.log(n),n},this.addCards=function(){if(arguments.length>0){var n=[],m=[];if("number"==typeof arguments[0])for(var t,s=i.length;i.length<s+arguments[0];)t=new card(Math.floor(4*Math.random()),Math.floor(13*Math.random())+1),this.searchCard(t)||(i.push(t),n.push(t),this.length++);else if("string"==typeof arguments[0]){arguments[0]}else{if(1==arguments.length)if(arguments[0]&&arguments[0].toArray)m=arguments[0].toArray();else if(arguments[0]&&arguments[0].length)m=arguments[0];else{if(!arguments[0]||!arguments[0].number)return new hand;m.push(arguments[0])}else m=arguments;for(var e=0;e<m.length;e++){if(!m[e].number)return new hand(n);i.push(m[e]),n.push(m[e]),this.length++}}return new hand(n)}},this.removeCards=function(){if(arguments.length>0){var n=new hand,m=[];if("number"==typeof arguments[0]){arguments[1]||r(i);for(var t=0;t<arguments[0];t++)n.addCards(i.pop());arguments[1]||e(i)}else{var s={};if(1==arguments.length)if(arguments[0]&&arguments[0].toArray)m=arguments[0].toArray();else if(arguments[0]&&arguments[0].length)m=arguments[0];else{if(!arguments[0]||!arguments[0].number)return new hand;m.push(arguments[0])}else m=arguments;for(var t=0;t<m.length;t++)s[13*m[t].type+m[t].number]=[m[t],0];for(var a=0;a<i.length;a++)s[13*i[a].type+i[a].number]&&(s[13*i[a].type+i[a].number][1]++,i.splice(a,1),a--);for(t=0;t<m.length;t++)for(var o=0;o<s[13*m[t].type+m[t].number][1];o++)n.addCards(s[13*m[t].type+m[t].number][0])}return this.length=i.length,n}},this.sort=function(n){return e(i),n&&i.reverse(),this.show()},this.removeDup=function(){return e(i,!0),this.length=i.length,i},this.shuffle=function(){return r(i),this.show()},this.searchCard=function(n){for(var m=0;m<i.length;m++)if(i[m].type==n.type&&i[m].number==n.number)return!0;return!1},this.check=function(){if(5==i.length){var n=a(i);return i=n.toArray(),console.log(rules[n.rank]),this.show()}},this.c5=function(){return i=t(),this.show()},this.sortT=function(){return s(i),this.show()},this.keyMap=function(){var n=new hand,m=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],t=[{0:0,n:[]},{0:0,n:[]},{0:0,n:[]},{0:0,n:[]},{0:0,n:[]}],s=[[0],[0],[0],[0],[0]];n.addCards(i),n=n.removeDup();for(var e=0;e<n.length;e++)m[n[e].number-1][n[e].type]=n[e],++m[n[e].number-1][5]||(m[n[e].number-1][5]=1),s[n[e].type].push(n[e].number),s[n[e].type][0]++;for(var e=0;e<m.length;e++)"number"!=typeof m[e][5]&&(m[e][5]=0),t[m[e][5]][0]++,t[m[e][5]].n.push(e);return{ns:m,ts:s,m:t}},n)if(n.toArray)var i=n.toArray();else"number"==typeof n?this.addCards(n):n.length&&(i=n,o(),this.length=i.length)}function deck(n,m){function t(n){for(var m=[],t=0;4>t;t++)for(var s=1;14>s;s++)m.push(new card(t,s));return n&&(m.push(new card(4,1)),m.push(new card(4,2))),m}function s(n,m,t){"number"==typeof t?m.addCards(n.removeCards(t).toArray()):n.searchCard(t)?m.addCards(n.removeCards(t).toArray()):console.log(t.typeName+" "+t.name+" not found.")}function e(n,m){m=isNaN(m)?1:parseInt(m),s(i.deck,n,m)}function r(n){for(var m=2==arguments.length&&arguments[1].length?[null].concat(arguments[1]):arguments,t=1;t<m.length;t++)s(n,i.field,m[t])}function a(n){for(var m=2==arguments.length&&arguments[1].length?[null].concat(arguments[1]):arguments,t=1;t<m.length;t++)s(n,i.discardD,m[t])}function o(n){for(var m=2==arguments.length&&arguments[1].length?[null].concat(arguments[1]):arguments,t=1;t<m.length;t++)s(i.discardD,n,m[t])}var i=this;this.createDeck=function(){this.deck=new hand(t())},this.addPlayer=function(n){n=""+n,this.players[n]=new hand,this.players[n].draw=function(m){e(i.players[n],m)},this.players[n].play=function(m){r(i.players[n],m)},this.players[n].discard=function(m){a(i.players[n],m)},this.players[n].restore=function(m){o(i.players[n],m)}},this.removePlayer=function(n){n=""+n,this.players[n]&&(this.players[n].discard(i.players[n].toArray()),delete this.players[n])},this.deal=function(n,m){if(i.players[n]){if("number"==typeof m||i.deck.searchCard(m))return s(i.deck,i.players[n],m),m;if(m&&m.length){m.toArray&&(m=m.toArray());for(var t=0,e=0;e<m.length;e++)i.deck.searchCard(m)&&(s(i.deck,i.players[n],m),t++);return t}if(void 0===m)return s(i.deck,i.players[n],1),1}return 0},this.discard=function(n){a(i.deck,n)},this.restore=function(n){o(i.deck,n)},this.reset=function(){this.createDeck(),this.players={},this.field=new hand,this.discardD=new hand},this.setup=function(){if(m&&m.length){for(var t=new hand,e=0;e<m.length;e++)s(this.deck,t,m[e]);this.discardD=this.deck,this.deck=t}if("object"==typeof n&&n.length)for(var r=0;r<n.length;r++)this.addPlayer(n[r]);else"string"==typeof n&&this.addPlayer(n)},this.clearPlaying=function(){this.discardD.addCards(i.field.toArray()),this.field=new hand},this.reset(),this.setup()}function chance(n,m){this.p=m,this.t=n,this.chance=m/n;var t=Math.round(1e6*this.chance)/1e4+"";for(-1==t.indexOf(".")&&(t+=".");t.substr(t.indexOf(".")).length<5;)t+="0";for(;t.substr(0,t.indexOf(".")).length<3;)t=" "+t;for(n+="",m+="";m.length<n.length;)m=" "+m;this.show=function(){var s="["+m+"/"+n+"] probability: "+t+" %";return console.log(s),s}}function chancePrep(n,m){var t,s,e,r=new hand,a=new hand;return r.addCards(n.toArray?n.toArray():n),a.addCards(m&&m.toArray?m.toArray():m),r.addCards(n),r.removeDup(),a.removeDup(),r.removeCards([card(4,1),card(4,2)]),a.removeCards([card(4,1),card(4,2)]),a.length&&a.length<=5&&(e=a.keyMap(),r.removeCards(a.toArray())),s=r.keyMap(),t=a.length>4?1:combination(r.length,5-a.length),{t:t,n:s,n2:e,tmp:r,tmp2:a}}function nothingChance(n,m,t){var s=chancePrep(n,m,t),e=0,r=s.tmp,a=s.t,o=s.n,i=s.tmp2,c=s.n2,h=[];switch(i.length){case 0:if(o.m[1][0]+o.m[2][0]+o.m[3][0]+o.m[4][0]>4){for(var u=0;u<o.ns.length;u++)h.push(o.ns[u][5]);e=cn(h,5),e-=flushChance(r).p,e-=straightChance(r).p,e-=sfChance(r).p}break;case 1:if(o.m[o.ns[c.m[1].n[0]][5]][0]--,o.m[1][0]+o.m[2][0]+o.m[3][0]+o.m[4][0]>3){for(var u=0;u<o.ns.length;u++)u!=c.m[1].n[0]&&h.push(o.ns[u][5]);e=cn(h,4),e-=flushChance(r,i).p,e-=straightChance(r,i).p,e-=sfChance(r,i).p}break;case 2:if(!c.m[2][0]&&(o.m[o.ns[c.m[1].n[0]][5]][0]--,o.m[o.ns[c.m[1].n[1]][5]][0]--,o.m[1][0]+o.m[2][0]+o.m[3][0]+o.m[4][0]>2)){for(var u=0;u<o.ns.length;u++)u!=c.m[1].n[0]&&u!=c.m[1].n[1]&&h.push(o.ns[u][5]);e=cn(h,3),e-=flushChance(r,i).p,e-=straightChance(r,i).p,e-=sfChance(r,i).p}break;case 3:if(!c.m[2][0]&&!c.m[3][0]&&(o.m[o.ns[c.m[1].n[0]][5]][0]--,o.m[o.ns[c.m[1].n[1]][5]][0]--,o.m[o.ns[c.m[1].n[2]][5]][0]--,o.m[1][0]+o.m[2][0]+o.m[3][0]+o.m[4][0]>1)){for(var u=0;u<o.ns.length;u++)u!=c.m[1].n[0]&&u!=c.m[1].n[1]&&u!=c.m[1].n[2]&&h.push(o.ns[u][5]);e=cn(h,2),e-=flushChance(r,i).p,e-=straightChance(r,i).p,e-=sfChance(r,i).p}break;case 4:c.m[2][0]||c.m[3][0]||c.m[4][0]||(o.m[o.ns[c.m[1].n[0]][5]][0]--,o.m[o.ns[c.m[1].n[1]][5]][0]--,o.m[o.ns[c.m[1].n[2]][5]][0]--,o.m[o.ns[c.m[1].n[3]][5]][0]--,o.m[1][0]+o.m[2][0]+o.m[3][0]+o.m[4][0]>0&&(e+=o.m[1][0]+2*o.m[2][0]+3*o.m[3][0]+4*o.m[4][0],e-=flushChance(r,i).p,e-=straightChance(r,i).p,e-=sfChance(r,i).p));break;case 5:5==c.m[1][0]&&(e=1,e-=flushChance(r,i).p,e-=straightChance(r,i).p,e-=sfChance(r,i).p)}return new chance(a,e)}function pairChance(n,m,t){var s=chancePrep(n,m,t),e=0,r=(s.tmp,s.t),a=s.n,o=s.tmp2,i=s.n2;switch(o.length){case 0:a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>3&&a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[4][0]*combination(4,2)*(combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1),3)-(a.m[4][0]-1)*combination(4,3)-a.m[3][0]*combination(3,3)-(a.m[4][0]-1)*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-2))-a.m[3][0]*combination(3,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*(a.m[4][0]-1))-a.m[2][0]*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*(a.m[4][0]-1))),e+=a.m[3][0]*combination(3,2)*(combination(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0],3)-a.m[4][0]*combination(4,3)-(a.m[3][0]-1)*combination(3,3)-a.m[4][0]*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*(a.m[4][0]-1))-(a.m[3][0]-1)*combination(3,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-2)+4*a.m[4][0])-a.m[2][0]*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*(a.m[3][0]-1)+4*a.m[4][0])),e+=a.m[2][0]*combination(2,2)*(combination(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*a.m[4][0],3)-a.m[4][0]*combination(4,3)-a.m[3][0]*combination(3,3)-a.m[4][0]*combination(4,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*(a.m[4][0]-1))-a.m[3][0]*combination(3,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*(a.m[3][0]-1)+4*a.m[4][0])-(a.m[2][0]-1)*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-2)+3*a.m[3][0]+4*a.m[4][0])));break;case 1:c2=a.ns[i.m[1].n[0]][5],(0==c2&&a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>2&&a.m[2][0]+a.m[3][0]+a.m[4][0]>0||c2>0&&a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>3)&&(a.m[c2][0]--,e+=a.m[4][0]*combination(4,2)*(combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1),2)-(a.m[4][0]-1)*combination(4,2)-a.m[3][0]*combination(3,2)-a.m[2][0]*combination(2,2)),e+=a.m[3][0]*combination(3,2)*(combination(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-(a.m[3][0]-1)*combination(3,2)-a.m[2][0]*combination(2,2)),e+=a.m[2][0]*combination(2,2)*(combination(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-a.m[3][0]*combination(3,2)-(a.m[2][0]-1)*combination(2,2)),e+=combination(c2,1)*(combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0],3)-a.m[4][0]*combination(4,3)-a.m[3][0]*combination(3,3)-a.m[4][0]*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1))-a.m[3][0]*combination(3,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0])-a.m[2][0]*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*a.m[4][0])));break;case 2:i.m[2][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>2&&(e+=combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0],3)-a.m[4][0]*combination(4,3)-a.m[3][0]*combination(3,3)-a.m[4][0]*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1))-a.m[3][0]*combination(3,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0])-a.m[2][0]*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*a.m[4][0]))):(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&a.m[2][0]+a.m[3][0]+a.m[4][0]+a.ns[i.m[1].n[0]][5]+a.ns[i.m[1].n[1]][5]>0&&(e+=a.m[4][0]*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1)),e+=a.m[3][0]*combination(3,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0]),e+=a.m[2][0]*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*a.m[4][0]),e+=a.ns[i.m[1].n[0]][5]*(combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-a.m[3][0]*combination(3,2)-a.m[2][0]*combination(2,2)),e+=a.ns[i.m[1].n[1]][5]*(combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-a.m[3][0]*combination(3,2)-a.m[2][0]*combination(2,2))));break;case 3:i.m[2][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&(e+=combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-a.m[3][0]*combination(3,2)-a.m[2][0]*combination(2,2))):i.m[1][0]&&(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.m[a.ns[i.m[1].n[2]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&a.m[2][0]+a.m[3][0]+a.m[4][0]+a.ns[i.m[1].n[0]][5]+a.ns[i.m[1].n[1]][5]+a.ns[i.m[1].n[2]][5]>0&&(e+=a.m[4][0]*combination(4,2)+a.m[3][0]*combination(3,2)+a.m[2][0]*combination(2,2),e+=a.ns[i.m[1].n[0]][5]*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])+a.ns[i.m[1].n[1]][5]*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])+a.ns[i.m[1].n[2]][5]*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])));break;case 4:i.m[4][0]||i.m[3][0]||i.m[2][0]>1||(i.m[2][0]&&i.m[1][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])):(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.m[a.ns[i.m[1].n[2]][5]][0]--,a.m[a.ns[i.m[1].n[3]][5]][0]--,a.ns[i.m[1].n[0]][5]+a.ns[i.m[1].n[1]][5]+a.ns[i.m[1].n[2]][5]+a.ns[i.m[1].n[3]][5]>0&&(e+=a.ns[i.m[1].n[0]][5]+a.ns[i.m[1].n[1]][5]+a.ns[i.m[1].n[2]][5]+a.ns[i.m[1].n[3]][5])));break;case 5:3==i.m[1][0]&&1==i.m[2][0]&&(e=1)}return new chance(r,e)}function tpChance(n,m,t){var s=chancePrep(n,m,t),e=0,r=(s.tmp,s.t),a=s.n,o=s.tmp2,i=s.n2;switch(o.length){case 0:a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>2&&a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&(e+=combination(a.m[2][0],2)*combination(2,2)*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-2)+3*a.m[3][0]+4*a.m[4][0]),e+=a.m[2][0]*a.m[3][0]*combination(2,2)*combination(3,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*(a.m[3][0]-1)+4*a.m[4][0]),e+=a.m[2][0]*a.m[4][0]*combination(2,2)*combination(4,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*(a.m[4][0]-1)),e+=combination(a.m[3][0],2)*combination(3,2)*combination(3,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-2)+4*a.m[4][0]),e+=a.m[3][0]*a.m[4][0]*combination(3,2)*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*(a.m[4][0]-1)),e+=combination(a.m[4][0],2)*combination(4,2)*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-2)));break;case 1:a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&(!a.ns[i.m[1].n[0]][5]&&a.m[2][0]+a.m[3][0]+a.m[4][0]>1||a.ns[i.m[1].n[0]][5]&&a.m[2][0]+a.m[3][0]+a.m[4][0]>0)&&(e+=combination(a.m[2][0],2)*combination(2,2)*combination(2,2),e+=a.m[2][0]*a.m[3][0]*combination(2,2)*combination(3,2),e+=a.m[2][0]*a.m[4][0]*combination(2,2)*combination(4,2),e+=combination(a.m[3][0],2)*combination(3,2)*combination(3,2),e+=a.m[3][0]*a.m[4][0]*combination(3,2)*combination(4,2),e+=combination(a.m[4][0],2)*combination(4,2)*combination(4,2),e+=a.ns[i.m[1].n[0]][5]*(a.m[4][0]*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1))+a.m[3][0]*combination(3,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0])+a.m[2][0]*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*a.m[4][0])));break;case 2:i.m[2][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[4][0]*combination(4,2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1)),e+=a.m[3][0]*combination(3,2)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0]),e+=a.m[2][0]*combination(2,2)*(a.m[1][0]+2*(a.m[2][0]-1)+3*a.m[3][0]+4*a.m[4][0]))):a.ns[i.m[1].n[0]][5]+a.ns[i.m[1].n[1]][5]>0&&(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(a.ns[i.m[1].n[0]][5]*a.ns[i.m[1].n[0]][5]||a.m[2][0]+a.m[3][0]+a.m[4][0]>0)&&(e+=a.ns[i.m[1].n[0]][5]*a.ns[i.m[1].n[1]][5]*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0]),e+=a.ns[i.m[1].n[0]][5]*(a.m[4][0]*combination(4,2)+a.m[3][0]*combination(3,2)+a.m[2][0]*combination(2,2)),e+=a.ns[i.m[1].n[1]][5]*(a.m[4][0]*combination(4,2)+a.m[3][0]*combination(3,2)+a.m[2][0]*combination(2,2))));break;case 3:i.m[2][0]?(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(a.ns[i.m[1].n[0]][5]||a.m[2][0]+a.m[3][0]+a.m[4][0]>0)&&(e+=a.m[4][0]*combination(4,2)+a.m[3][0]*combination(3,2)+a.m[2][0]*combination(2,2),e+=a.ns[i.m[1].n[0]][5]*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0]))):i.m[1][0]&&(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.m[a.ns[i.m[1].n[2]][5]][0]--,(a.ns[i.m[1].n[0]][5]&&a.ns[i.m[1].n[1]][5]||a.ns[i.m[1].n[0]][5]&&a.ns[i.m[1].n[2]][5]||a.ns[i.m[1].n[1]][5]&&a.ns[i.m[1].n[2]][5])&&(e+=a.ns[i.m[1].n[0]][5]*a.ns[i.m[1].n[1]][5]+a.ns[i.m[1].n[0]][5]*a.ns[i.m[1].n[2]][5]+a.ns[i.m[1].n[1]][5]*a.ns[i.m[1].n[2]][5]));break;case 4:2==i.m[2][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[2].n[1]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])):i.m[2][0]&&i.m[1][0]&&(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,(a.ns[i.m[1].n[0]][5]||a.ns[i.m[1].n[1]][5])&&(e+=a.ns[i.m[1].n[0]][5]+a.ns[i.m[1].n[1]][5]));break;case 5:2==i.m[2][0]&&1==i.m[1][0]&&(e=1)}return new chance(r,e)}function toakChance(n,m,t){var s=chancePrep(n,m,t),e=0,r=(s.tmp,s.t),a=s.n,o=s.tmp2,i=s.n2;switch(o.length){case 0:a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>2&&(a.m[3][0]||a.m[4][0])&&(e+=a.m[4][0]*combination(4,3)*(combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1),2)-(a.m[4][0]-1)*combination(4,2)-a.m[3][0]*combination(3,2)-a.m[2][0]*combination(2,2)),e+=a.m[3][0]*combination(3,3)*(combination(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-(a.m[3][0]-1)*combination(3,2)-a.m[2][0]*combination(2,2)));break;case 1:a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&(a.ns[i.m[1].n[0]][5]>1||a.m[3][0]||a.m[4][0])&&(e+=a.m[4][0]*combination(4,3)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1)),e+=a.m[3][0]*combination(3,3)*(a.m[1][0]+2*a.m[2][0]+3*(a.m[3][0]-1)+4*a.m[4][0]),e+=combination(a.ns[i.m[1].n[0]][5],2)*(combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-a.m[3][0]*combination(3,2)-a.m[2][0]*combination(2,2)));break;case 2:i.m[2][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.ns[i.m[2].n[0]][5]&&a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&(e+=a.ns[i.m[2].n[0]][5]*(combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-a.m[3][0]*combination(3,2)-a.m[2][0]*combination(2,2)))):(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(a.ns[i.m[1].n[0]][5]>1||a.ns[i.m[1].n[1]][5]>1||a.m[3][0]||a.m[4][0])&&(e+=a.m[4][0]*combination(4,3),e+=a.m[3][0]*combination(3,3),e+=combination(a.ns[i.m[1].n[0]][5],2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0]),e+=combination(a.ns[i.m[1].n[1]][5],2)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])));break;case 3:i.m[3][0]?(a.m[a.ns[i.m[3].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&(e+=combination(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0],2)-a.m[4][0]*combination(4,2)-a.m[3][0]*combination(3,2)-a.m[2][0]*combination(2,2))):i.m[2][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,a.ns[i.m[2].n[0]][5]>0&&a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.ns[i.m[2].n[0]][5]*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0]))):(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.m[a.ns[i.m[1].n[2]][5]][0]--,(a.ns[i.m[1].n[0]][5]>1||a.ns[i.m[1].n[1]][5]>1||a.ns[i.m[1].n[2]][5]>1)&&(e+=combination(a.ns[i.m[1].n[0]][5],2)+combination(a.ns[i.m[1].n[1]][5],2)+combination(a.ns[i.m[1].n[2]][5],2)));break;case 4:i.m[3][0]?(a.m[a.ns[i.m[3].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])):i.m[2][0]&&i.m[1][0]&&(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.ns[i.m[2].n[0]][5]&&(e+=a.ns[i.m[2].n[0]][5]));break;case 5:i.m[3][0]&&i.m[1][0]&&(e=1)}return new chance(r,e)}function straightChance(n,m,t){var s=chancePrep(n,m,t),e=0,r=s.tmp,a=s.t,o=s.n,i=s.tmp2,c=s.n2;switch(i.length){case 0:for(var h=0;10>h;h++)e+=o.ns[h][5]*o.ns[h+1][5]*o.ns[h+2][5]*o.ns[h+3][5]*o.ns[h+4>12?0:h+4][5];e-=sfChance(r).p;break;case 1:o.ns[c.m[1].n[0]][5]=1;for(var h=c.m[1].n[0]-4<0?0:c.m[1].n[0]-4;h<(c.m[1].n[0]>9?10:c.m[1].n[0]+1);h++)e+=o.ns[h][5]*o.ns[h+1][5]*o.ns[h+2][5]*o.ns[h+3][5]*o.ns[h+4>12?0:h+4][5],0==h&&(e+=o.ns[0][5]*o.ns[9][5]*o.ns[10][5]*o.ns[11][5]*o.ns[12][5]);e-=sfChance(r,i).p;break;case 2:if(!c.m[2][0]&&(Math.abs(c.m[1].n[0]-c.m[1].n[1])<5||0==c.m[1].n[0]&&c.m[1].n[1]>8)){o.ns[c.m[1].n[0]][5]=1,o.ns[c.m[1].n[1]][5]=1;for(var h=c.m[1].n[1]-4<0?0:c.m[1].n[1]-4;h<(c.m[1].n[0]>9?10:0==c.m[1].n[0]?c.m[1].n[1]+1:c.m[1].n[0]+1);h++)(c.m[1].n[0]<h||c.m[1].n[0]>h+4)&&(9!=h||0!=c.m[1].n[0])||c.m[1].n[1]<h||c.m[1].n[1]>h+4||(e+=o.ns[h][5]*o.ns[h+1][5]*o.ns[h+2][5]*o.ns[h+3][5]*o.ns[h+4>12?0:h+4][5]),0==h&&(0==c.m[1].n[0]||c.m[1].n[0]>8&&c.m[1].n[0]<13)&&(0==c.m[1].n[1]||c.m[1].n[1]>8&&c.m[1].n[1]<13)&&(e+=o.ns[0][5]*o.ns[9][5]*o.ns[10][5]*o.ns[11][5]*o.ns[12][5]);e-=sfChance(r,i).p}break;case 3:if(!c.m[3][0]&&!c.m[2][0]&&(Math.abs(c.m[1].n[0]-c.m[1].n[2])<5||0==c.m[1].n[0]&&c.m[1].n[1]>8)){o.ns[c.m[1].n[0]][5]=1,o.ns[c.m[1].n[1]][5]=1,o.ns[c.m[1].n[2]][5]=1;for(var h=c.m[1].n[1]-4<0?0:c.m[1].n[1]-4;h<(c.m[1].n[0]>9?10:0==c.m[1].n[0]?c.m[1].n[1]+1:c.m[1].n[0]+1);h++)(c.m[1].n[0]<h||c.m[1].n[0]>h+4)&&(9!=h||0!=c.m[1].n[0])||c.m[1].n[1]<h||c.m[1].n[1]>h+4||c.m[1].n[2]<h||c.m[1].n[2]>h+4||(e+=o.ns[h][5]*o.ns[h+1][5]*o.ns[h+2][5]*o.ns[h+3][5]*o.ns[h+4>12?0:h+4][5]),0==h&&(0==c.m[1].n[0]||c.m[1].n[0]>8&&c.m[1].n[0]<13)&&(0==c.m[1].n[1]||c.m[1].n[1]>8&&c.m[1].n[1]<13)&&(0==c.m[1].n[2]||c.m[1].n[2]>8&&c.m[1].n[2]<13)&&(e+=o.ns[0][5]*o.ns[9][5]*o.ns[10][5]*o.ns[11][5]*o.ns[12][5]);e-=sfChance(r,i).p}break;case 4:if(!c.m[4][0]&&!c.m[3][0]&&!c.m[2][0]&&(Math.abs(c.m[1].n[0]-c.m[1].n[3])<5||0==c.m[1].n[0]&&c.m[1].n[1]>8)){o.ns[c.m[1].n[0]][5]=1,o.ns[c.m[1].n[1]][5]=1,o.ns[c.m[1].n[2]][5]=1,o.ns[c.m[1].n[3]][5]=1;for(var h=c.m[1].n[1]-4<0?0:c.m[1].n[1]-4;h<(c.m[1].n[0]>9?10:0==c.m[1].n[0]?c.m[1].n[1]+1:c.m[1].n[0]+1);h++)(c.m[1].n[0]<h||c.m[1].n[0]>h+4)&&(9!=h||0!=c.m[1].n[0])||c.m[1].n[1]<h||c.m[1].n[1]>h+4||c.m[1].n[2]<h||c.m[1].n[2]>h+4||c.m[1].n[3]<h||c.m[1].n[3]>h+4||(e+=o.ns[h][5]*o.ns[h+1][5]*o.ns[h+2][5]*o.ns[h+3][5]*o.ns[h+4>12?0:h+4][5]),0==h&&(0==c.m[1].n[0]||c.m[1].n[0]>8&&c.m[1].n[0]<13)&&(0==c.m[1].n[1]||c.m[1].n[1]>8&&c.m[1].n[1]<13)&&(0==c.m[1].n[2]||c.m[1].n[2]>8&&c.m[1].n[2]<13)&&(0==c.m[1].n[3]||c.m[1].n[3]>8&&c.m[1].n[3]<13)&&(e+=o.ns[0][5]*o.ns[9][5]*o.ns[10][5]*o.ns[11][5]*o.ns[12][5]);e-=sfChance(r,i).p}break;case 5:c.m[4][0]||c.m[3][0]||c.m[2][0]||!(Math.abs(c.m[1].n[0]-c.m[1].n[3])<5||0==c.m[1].n[0]&&c.m[1].n[1]>8)||(c.m[1].n[0]==c.m[1].n[1]-1&&c.m[1].n[1]==c.m[1].n[2]-1&&c.m[1].n[2]==c.m[1].n[3]-1&&c.m[1].n[3]==c.m[1].n[4]-1||0==c.m[1].n[0]&&9==c.m[1].n[1]&&10==c.m[1].n[2]&&11==c.m[1].n[3]&&12==c.m[1].n[4])&&(e=1,e-=sfChance(r,i).p)}return new chance(a,e)}function flushChance(n,m,t){{var s=chancePrep(n,m,t),e=0,r=s.tmp,a=s.t,o=s.n,i=s.tmp2;s.n2}switch(i.length){case 0:(o.ts[0][0]>4||o.ts[1][0]>4||o.ts[2][0]>4||o.ts[3][0]>4)&&(e+=combination(o.ts[0][0],5)+combination(o.ts[1][0],5)+combination(o.ts[2][0],5)+combination(o.ts[3][0],5),e-=sfChance(r).p);break;case 1:o.ts[i.toArray()[0].type][0]>3&&(e+=combination(o.ts[i.toArray()[0].type][0],4),e-=sfChance(r,i).p);break;case 2:i.toArray()[0].type==i.toArray()[1].type&&o.ts[i.toArray()[0].type][0]>2&&(e+=combination(o.ts[i.toArray()[0].type][0],3),e-=sfChance(r,i).p);break;case 3:i.toArray()[0].type==i.toArray()[1].type&&i.toArray()[1].type==i.toArray()[2].type&&o.ts[i.toArray()[0].type][0]>1&&(e+=combination(o.ts[i.toArray()[0].type][0],2),e-=sfChance(r,i).p);break;case 4:i.toArray()[0].type==i.toArray()[1].type&&i.toArray()[1].type==i.toArray()[2].type&&i.toArray()[2].type==i.toArray()[3].type&&o.ts[i.toArray()[0].type][0]>0&&(e+=o.ts[i.toArray()[0].type][0],e-=sfChance(r,i).p);break;case 5:i.toArray()[0].type==i.toArray()[1].type&&i.toArray()[1].type==i.toArray()[2].type&&i.toArray()[2].type==i.toArray()[3].type&&i.toArray()[3].type==i.toArray()[4].type&&(e=1,e-=sfChance(r,i).p)}return new chance(a,e)}function fhChance(n,m,t){var s=chancePrep(n,m,t),e=0,r=(s.tmp,s.t),a=s.n,o=s.tmp2,i=s.n2;switch(o.length){case 0:a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&a.m[3][0]+a.m[4][0]>0&&(e+=a.m[4][0]*combination(4,3)*((a.m[4][0]-1)*combination(4,2)+a.m[3][0]*combination(3,2)+a.m[2][0]*combination(2,2)),e+=a.m[3][0]*combination(3,3)*(a.m[4][0]*combination(4,2)+(a.m[3][0]-1)*combination(3,2)+a.m[2][0]*combination(2,2)));break;case 1:a.m[a.ns[i.m[1].n[0]][5]][0]--,(1==a.ns[i.m[1].n[0]][5]&&a.m[3][0]+a.m[4][0]>0||a.ns[i.m[1].n[0]][5]>1&&a.m[2][0]+a.m[3][0]+a.m[4][0]>0)&&(e+=combination(a.ns[i.m[1].n[0]][5],2)*(a.m[4][0]*combination(4,2)+a.m[3][0]*combination(3,2)+a.m[2][0]*combination(2,2)),e+=combination(a.ns[i.m[1].n[0]][5],1)*(a.m[4][0]*combination(4,3)+a.m[3][0]*combination(3,3)));break;case 2:i.m[2][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,(a.ns[i.m[2].n[0]][5]&&a.m[2][0]+a.m[3][0]+a.m[4][0]>0||a.m[3][0]+a.m[4][0]>0)&&(e+=a.m[4][0]*combination(4,3)+a.m[3][0]*combination(3,3),e+=a.ns[i.m[2].n[0]][5]*(a.m[4][0]*combination(4,2)+a.m[3][0]*combination(3,2)+a.m[2][0]*combination(2,2)))):(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,a.ns[i.m[1].n[0]][5]*a.ns[i.m[1].n[1]][5]>1&&(e+=combination(a.ns[i.m[1].n[0]][5],2)*a.ns[i.m[1].n[1]][5],e+=combination(a.ns[i.m[1].n[1]][5],2)*a.ns[i.m[1].n[0]][5]));break;case 3:i.m[3][0]?(a.m[a.ns[i.m[3].n[0]][5]][0]--,a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[4][0]*combination(4,2)+a.m[3][0]*combination(3,2)+a.m[2][0]*combination(2,2))):i.m[2][0]&&(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,(a.ns[i.m[2].n[0]][5]&&a.ns[i.m[1].n[0]][5]||a.ns[i.m[1].n[0]][5]>1)&&(e+=a.ns[i.m[2].n[0]][5]*a.ns[i.m[1].n[0]][5],e+=combination(a.ns[i.m[1].n[0]][5],2)));break;case 4:i.m[3][0]?(a.m[a.ns[i.m[3].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,a.ns[i.m[1].n[0]][5]&&(e+=a.ns[i.m[1].n[0]][5])):2==i.m[2][0]&&(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[2].n[1]][5]][0]--,(a.ns[i.m[2].n[0]][5]||a.ns[i.m[2].n[1]][5])&&(e+=a.ns[i.m[2].n[0]][5]+a.ns[i.m[2].n[1]][5]));break;case 5:i.m[3][0]&&i.m[2][0]&&(e=1)}return new chance(r,e)}function foakChance(n,m,t){var s=chancePrep(n,m,t),e=0,r=(s.tmp,s.t),a=s.n,o=s.tmp2,i=s.n2;switch(o.length){case 0:a.m[4][0]&&a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>1&&(e+=a.m[4][0]*combination(4,4)*(a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*(a.m[4][0]-1)));break;case 1:a.m[a.ns[i.m[1].n[0]][5]][0]--,3==a.ns[i.m[1].n[0]][5]&&a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0]),a.m[4][0]>0&&(e+=a.m[4][0]);break;case 2:i.m[2][0]?(a.m[a.ns[i.m[2].n[0]][5]][0]--,2==a.ns[i.m[2].n[0]][5]&&a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])):(a.m[a.ns[i.m[1].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[1]][5]][0]--,(3==a.ns[i.m[1].n[0]][5]||3==a.ns[i.m[1].n[1]][5])&&(e+=combination(a.ns[i.m[1].n[0]][5],3)+combination(a.ns[i.m[1].n[1]][5],3)));
break;case 3:i.m[3][0]?(a.m[a.ns[i.m[3].n[0]][5]][0]--,1==a.ns[i.m[3].n[0]][5]&&a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])):i.m[2][0]&&(a.m[a.ns[i.m[2].n[0]][5]][0]--,a.m[a.ns[i.m[1].n[0]][5]][0]--,2==a.ns[i.m[2].n[0]][5]&&(e=1));break;case 4:i.m[4][0]?(a.m[a.ns[i.m[4].n[0]][5]][0]--,a.m[1][0]+a.m[2][0]+a.m[3][0]+a.m[4][0]>0&&(e+=a.m[1][0]+2*a.m[2][0]+3*a.m[3][0]+4*a.m[4][0])):i.m[3][0]&&1==a.ns[i.m[3].n[0]][5]&&(e=1);break;case 5:i.m[4][0]&&(e=1)}return new chance(r,e)}function sfChance(n,m,t){var s=chancePrep(n,m,t),e=0,r=(s.tmp,s.t),a=s.n,o=s.tmp2,i=s.n2;switch(o.length){case 0:if(a.ts[0][0]>4||a.ts[1][0]>4||a.ts[2][0]>4||a.ts[3][0]>4)for(var c=0;4>c;c++)for(var h=1;h<a.ts[c].length-3;h++)a.ts[c][h]==a.ts[c][h+1]-1&&a.ts[c][h+1]-1==a.ts[c][h+2]-2&&a.ts[c][h+2]-2==a.ts[c][h+3]-3&&a.ts[c][h+3]-3==(h+4<a.ts[c].length?a.ts[c][h+4]-4:a.ts[c][1]+9)&&e++;break;case 1:var c=o.toArray()[0].type;if(a.ts[c][0]>3){for(var u=1,b=1;u<a.ts[c].length&&b<i.ts[c].length;u++)a.ts[c][u]>i.ts[c][b]&&(a.ts[c].splice(u,0,i.ts[c][b]),a.ts[c][0]++,b++);for(var h=b;h<i.ts[c].length;h++)a.ts[c].push(i.ts[c][h]),a.ts[c][0]++;for(var h=1;h<a.ts[c].length-3;h++)a.ts[c][h]!=a.ts[c][h+1]-1||a.ts[c][h+1]-1!=a.ts[c][h+2]-2||a.ts[c][h+2]-2!=a.ts[c][h+3]-3||a.ts[c][h+3]-3!=(h+4<a.ts[c].length?a.ts[c][h+4]-4:a.ts[c][1]+9)||i.ts[c][1]!=a.ts[c][h]&&i.ts[c][1]!=a.ts[c][h+1]&&i.ts[c][1]!=a.ts[c][h+2]&&i.ts[c][1]!=a.ts[c][h+3]&&i.ts[c][1]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||e++}break;case 2:if(o.toArray()[0].type==o.toArray()[1].type&&a.ts[o.toArray()[0].type][0]>2){var c=o.toArray()[0].type;if(a.ts[c][0]>2){for(var u=1,b=1;u<a.ts[c].length&&b<i.ts[c].length;u++)a.ts[c][u]>i.ts[c][b]&&(a.ts[c].splice(u,0,i.ts[c][b]),a.ts[c][0]++,b++);for(var h=b;h<i.ts[c].length;h++)a.ts[c].push(i.ts[c][h]),a.ts[c][0]++;for(var h=1;h<a.ts[c].length-3;h++)a.ts[c][h]!=a.ts[c][h+1]-1||a.ts[c][h+1]-1!=a.ts[c][h+2]-2||a.ts[c][h+2]-2!=a.ts[c][h+3]-3||a.ts[c][h+3]-3!=(h+4<a.ts[c].length?a.ts[c][h+4]-4:a.ts[c][1]+9)||i.ts[c][1]!=a.ts[c][h]&&i.ts[c][1]!=a.ts[c][h+1]&&i.ts[c][1]!=a.ts[c][h+2]&&i.ts[c][1]!=a.ts[c][h+3]&&i.ts[c][1]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||i.ts[c][2]!=a.ts[c][h]&&i.ts[c][2]!=a.ts[c][h+1]&&i.ts[c][2]!=a.ts[c][h+2]&&i.ts[c][2]!=a.ts[c][h+3]&&i.ts[c][2]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||e++}}break;case 3:if(o.toArray()[0].type==o.toArray()[1].type&&o.toArray()[1].type==o.toArray()[2].type&&a.ts[o.toArray()[0].type][0]>1){var c=o.toArray()[0].type;if(a.ts[c][0]>1){for(var u=1,b=1;u<a.ts[c].length&&b<i.ts[c].length;u++)a.ts[c][u]>i.ts[c][b]&&(a.ts[c].splice(u,0,i.ts[c][b]),a.ts[c][0]++,b++);for(var h=b;h<i.ts[c].length;h++)a.ts[c].push(i.ts[c][h]),a.ts[c][0]++;for(var h=1;h<a.ts[c].length-3;h++)a.ts[c][h]!=a.ts[c][h+1]-1||a.ts[c][h+1]-1!=a.ts[c][h+2]-2||a.ts[c][h+2]-2!=a.ts[c][h+3]-3||a.ts[c][h+3]-3!=(h+4<a.ts[c].length?a.ts[c][h+4]-4:a.ts[c][1]+9)||i.ts[c][1]!=a.ts[c][h]&&i.ts[c][1]!=a.ts[c][h+1]&&i.ts[c][1]!=a.ts[c][h+2]&&i.ts[c][1]!=a.ts[c][h+3]&&i.ts[c][1]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||i.ts[c][2]!=a.ts[c][h]&&i.ts[c][2]!=a.ts[c][h+1]&&i.ts[c][2]!=a.ts[c][h+2]&&i.ts[c][2]!=a.ts[c][h+3]&&i.ts[c][2]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||i.ts[c][3]!=a.ts[c][h]&&i.ts[c][3]!=a.ts[c][h+1]&&i.ts[c][3]!=a.ts[c][h+2]&&i.ts[c][3]!=a.ts[c][h+3]&&i.ts[c][3]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||e++}}break;case 4:if(o.toArray()[0].type==o.toArray()[1].type&&o.toArray()[1].type==o.toArray()[2].type&&o.toArray()[2].type==o.toArray()[3].type&&a.ts[o.toArray()[0].type][0]>0){var c=o.toArray()[0].type;if(a.ts[c][0]){for(var u=1,b=1;u<a.ts[c].length&&b<i.ts[c].length;u++)a.ts[c][u]>i.ts[c][b]&&(a.ts[c].splice(u,0,i.ts[c][b]),a.ts[c][0]++,b++);for(var h=b;h<i.ts[c].length;h++)a.ts[c].push(i.ts[c][h]),a.ts[c][0]++;for(var h=1;h<a.ts[c].length-3;h++)a.ts[c][h]!=a.ts[c][h+1]-1||a.ts[c][h+1]-1!=a.ts[c][h+2]-2||a.ts[c][h+2]-2!=a.ts[c][h+3]-3||a.ts[c][h+3]-3!=(h+4<a.ts[c].length?a.ts[c][h+4]-4:a.ts[c][1]+9)||i.ts[c][1]!=a.ts[c][h]&&i.ts[c][1]!=a.ts[c][h+1]&&i.ts[c][1]!=a.ts[c][h+2]&&i.ts[c][1]!=a.ts[c][h+3]&&i.ts[c][1]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||i.ts[c][2]!=a.ts[c][h]&&i.ts[c][2]!=a.ts[c][h+1]&&i.ts[c][2]!=a.ts[c][h+2]&&i.ts[c][2]!=a.ts[c][h+3]&&i.ts[c][2]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||i.ts[c][3]!=a.ts[c][h]&&i.ts[c][3]!=a.ts[c][h+1]&&i.ts[c][3]!=a.ts[c][h+2]&&i.ts[c][3]!=a.ts[c][h+3]&&i.ts[c][3]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||i.ts[c][4]!=a.ts[c][h]&&i.ts[c][4]!=a.ts[c][h+1]&&i.ts[c][4]!=a.ts[c][h+2]&&i.ts[c][4]!=a.ts[c][h+3]&&i.ts[c][4]!=a.ts[c][h+4<a.ts[c].length?h+4:1]||e++}}break;case 5:var c=o.toArray()[0].type;c==o.toArray()[1].type&&c==o.toArray()[2].type&&c==o.toArray()[3].type&&c==o.toArray()[4].type&&(i.ts[c][1]==i.ts[c][2]-1&&i.ts[c][2]==i.ts[c][3]-1&&i.ts[c][3]==i.ts[c][4]-1&&i.ts[c][4]==i.ts[c][5]-1||1==i.ts[c][1]&&10==i.ts[c][2]&&11==i.ts[c][3]&&12==i.ts[c][4]&&13==i.ts[c][5])&&(e=1)}return new chance(r,e)}function checkP(n,m){var t,s,e,r,a,o,i,c,h,u,b;return e=nothingChance(n,m),r=pairChance(n,m),a=tpChance(n,m),o=toakChance(n,m),i=straightChance(n,m),c=flushChance(n,m),h=fhChance(n,m),u=foakChance(n,m),b=sfChance(n,m),console.log("Cards:"),n.sort(),console.log("Straight Flush:"),b.show(),console.log("Four of a Kind:"),u.show(),console.log("Full House:"),h.show(),console.log("Flush:"),c.show(),console.log("Straight:"),i.show(),console.log("Three of a Kind:"),o.show(),console.log("Two Pair:"),a.show(),console.log("Pair:"),r.show(),console.log("Nothing:"),e.show(),t=e.p+r.p+a.p+o.p+i.p+c.p+h.p+u.p+b.p,s=b.t,[e,r,a,o,i,c,h,u,b,new chance(s,t)]}var types={0:"Spade",1:"Heart",2:"Diamond",3:"Club",4:"Joker"},rules={0:"Nothing",1:"Pair",2:"Two Pair",3:"Three of a Kind",4:"Straight",5:"Flush",6:"Full House",7:"Four of a Kind",8:"Straight Flush"};