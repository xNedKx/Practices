function factorial(a){var b=1;if(a>0){a=parseInt(a);do b*=a;while(--a)}return b}function combinationF(a,b){return a>=b?factorial(a)/(factorial(b)*factorial(a-b)):0}function combination(a,b){if(a>=b&&a>0&&b>0){var c,d;a=parseInt(a),b=parseInt(b),c=1,d=1,b=2*b>a?a-b:b;for(var e=0;b>e;e++)c*=a,a--;for(;b>0;)d*=b,b--;return c/d}return 0}function permutation(a,b){if(a>=b&&a>0&&b>0){var c=1;a=parseInt(a),b=parseInt(b);for(var d=0;b>d;d++)c*=a,a--;return c}return 0}function cn(a,b){var c=[],d=0,e=[];for(c[0]=0;c[0]<a.length-b+1;c[0]++)if(e[0]=a[c[0]],1==b)d+=e[0];else for(c[1]=c[0]+1;c[1]<a.length-b+2;c[1]++)if(e[1]=e[0]*a[c[1]],2==b)d+=e[1];else for(c[2]=c[1]+1;c[2]<a.length-b+3;c[2]++)if(e[2]=e[1]*a[c[2]],3==b)d+=e[2];else for(c[3]=c[2]+1;c[3]<a.length-b+4;c[3]++)if(e[3]=e[2]*a[c[3]],4==b)d+=e[3];else for(c[4]=c[3]+1;c[4]<a.length-b+3;c[4]++)e[4]=e[3]*a[c[4]],d+=e[4];return d}function card(a,b){return types[a]&&(b=parseInt(b))>0&&14>b&&2==arguments.length?(this.type=a,this.number=b,this.name=4==a?1==b?"Red":"Black":2>b?"A":11>b?b.toString():12>b?"J":13>b?"Q":"K",this.typeName=types[a],this.show=function(){var a=this.typeName+" "+this.name;return console.log(a),a},new arguments.callee(a,b,1)):types[a]&&(b=parseInt(b))>0&&14>b&&3==arguments.length&&arguments[2]?(this.type=a,this.number=b,this.name=4==a?1==b?"Red":"Black":2>b?"A":11>b?b.toString():12>b?"J":13>b?"Q":"K",this.typeName=types[a],this.show=function(){var a=this.typeName+" "+this.name;return console.log(a),a},!0):null}function rank(a,b){if(5==a.length){var b=1==arguments.length?check5(a).rank:b,a=1==arguments.length?check5(a).toArray():a;this.rank=b,this.show=function(){for(var c=rules[b]+": ",d=0;d<a.length;d++)c+=a[d].typeName+" "+a[d].name+(d<a.length-1?" , ":"");return console.log(c),c},this.toArray=function(){return a},this.comp=function(c){var d=c.toArray();if(5==a.length&&5==d.length){if(b>c.rank)return!0;if(b<c.rank)return!1;switch(b){case 0:for(var e=0;5>e;e++){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null;case 1:for(var e=0;5>e;e++)if(1!=e){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null;case 2:for(var e=0;5>e;e++)if(1!=e&&3!=e){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null;case 3:for(var e=0;5>e;e++)if(1!=e&&2!=e){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null;case 4:for(var e=0;5>e;e++){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null;case 5:for(var e=0;5>e;e++){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null;case 6:for(var e=0;5>e;e++)if(1!=e&&2!=e&&4!=e){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null;case 7:for(var e=0;5>e;e++)if(1!=e&&2!=e&&3!=e){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null;case 8:for(var e=0;5>e;e++){if(a[e].number>d[e].number)return!0;if(a[e].number<d[e].number)return!1}return null}}}}}function hand(a){function c(a){a=f(a);for(var b=0;b<a.length;b++)b>0&&a[b].type==a[b-1].type&&a[b].number==a[b-1].number&&a.splice(b,1);return a}function d(){for(var a=[];a.length<5;)a.push(new card(Math.floor(4*Math.random()),Math.floor(13*Math.random())+1)),c(a);return a}function e(a){for(var b=0,c=0,d=0,e=0,f=0;f<a.length;f++)switch(a[f].type){case 0:a.unshift(a.splice(f,1)[0]),b++,c++,d++,e++;break;case 1:a.splice(b,0,a.splice(f,1)[0]),c++,d++,e++;break;case 2:a.splice(c,0,a.splice(f,1)[0]),d++,e++;break;case 3:a.splice(d,0,a.splice(f,1)[0]),e++;break;case 4:a.push(a.splice(f,1)[0]);break;default:return null}for(var g=0;g<a.length;g++)if(b>g)for(var h=g;h>0;h--)a[h].number<a[h-1].number&&a.splice(h-1,0,a.splice(h,1)[0]);else if(c>g)for(h=g;h>b;h--)a[h].number<a[h-1].number&&a.splice(h-1,0,a.splice(h,1)[0]);else if(d>g)for(h=g;h>c;h--)a[h].number<a[h-1].number&&a.splice(h-1,0,a.splice(h,1)[0]);else if(e>g)for(h=g;h>d;h--)a[h].number<a[h-1].number&&a.splice(h-1,0,a.splice(h,1)[0]);return a}function f(a){a:for(var b=0;b<a.length;b++)for(var c=b;c>0;c--)if(a[c].number<a[c-1].number||a[c].number==a[c-1].number&&a[c].type<a[c-1].type)a.splice(c-1,0,a.splice(c,1)[0]);else if(arguments[1]&&a[c].number==a[c-1].number&&a[c].type==a[c-1].type){a.splice(c-1,1),b--;continue a}return a}function g(a){for(var b=a.length;b>0;b--)a.push(a.splice(Math.floor(Math.random()*b),1)[0]);return a}function h(a){if(5==a.length){var e,b={p:0,k3:!1,k4:!1,s:!0,f:!0,pn:[],k3n:0,k4n:0,o:[],h:[]},c={t:[],n:{}},d=1,g={};a=f(a);for(var h=0;5>h;h++)if(c.t[a[h].type]?c.t[a[h].type]++:c.t[a[h].type]=1,c.n[a[h].number]?c.n[a[h].number]++:c.n[a[h].number]=1,h>0&&a[h].number==a[h-1].number){if(b.s=!1,b.f=!1,d++,4==h)switch(d){case 2:b.p++,b.pn.push(a[h].number),b.k3?(b.h.push(a[h-1]),b.h.push(a[h])):(b.h.unshift(a[h]),b.h.unshift(a[h-1]));break;case 3:b.k3=!0,b.k3n=a[h].number,b.h.unshift(a[h]),b.h.unshift(a[h-1]),b.h.unshift(a[h-2]);break;case 4:b.k4=!0,b.k4n=a[h].number,b.h.unshift(a[h]),b.h.unshift(a[h-1]),b.h.unshift(a[h-2]),b.h.unshift(a[h-3])}}else{switch(d){case 1:b.s&&(a[h].number==a[0].number+h||1==a[0].number&&a[h].number==9+h||(b.s=!1)),h>0&&b.o.unshift(a[h-1]);break;case 2:b.p++,b.pn.push(a[h-1].number),b.k3?(b.h.push(a[h-2]),b.h.push(a[h-1])):(b.h.unshift(a[h-1]),b.h.unshift(a[h-2]));break;case 3:b.k3=!0,b.k3n=a[h-1].number,b.h.unshift(a[h-1]),b.h.unshift(a[h-2]),b.h.unshift(a[h-3]);break;case 4:b.k4=!0,b.k4n=a[h-1].number,b.h.unshift(a[h-1]),b.h.unshift(a[h-2]),b.h.unshift(a[h-3]),b.h.unshift(a[h-4])}d=1,4==h&&b.o.unshift(a[h])}b.o.length>0&&1==b.o[b.o.length-1].number&&(b.s&&2!=b.o[b.o.length-2].number||!b.s)&&b.o.unshift(b.o.pop()),2==b.p&&1==b.h[b.h.length-1].number&&(b.h.unshift(b.h.pop()),b.h.unshift(b.h.pop())),g=b.h.concat(b.o),b.f&&c.t.length>1&&(b.f=0),e=b.s&&b.f?8:b.k4?7:b.k3&&b.p?6:b.f?5:b.s?4:b.k3?3:2==b.p?2:b.p?1:0}return new rank(g,e)}function i(){for(var a=0;a<b.length;a++)b[a].number&&b[a].name&&b[a].typeName&&b[a].show&&b[a].number>0&&b[a].number<14&&types[b[a].type]||(b.splice(a,1),a--)}var b=[];if(this.toArray=function(){return b},this.length=b.length,this.show=function(){for(var a="",c=0;c<b.length;c++)a+=b[c].typeName+" "+b[c].name+(c<b.length-1?" , ":"");return console.log(a),a},this.addCards=function(){if(arguments.length>0){var a=[],c=[];if("number"==typeof arguments[0])for(var e,d=b.length;b.length<d+arguments[0];)e=new card(Math.floor(4*Math.random()),Math.floor(13*Math.random())+1),this.searchCard(e)||(b.push(e),a.push(e),this.length++);else if("string"==typeof arguments[0])arguments[0];else{if(1==arguments.length)if(arguments[0]&&arguments[0].toArray)c=arguments[0].toArray();else if(arguments[0]&&arguments[0].length)c=arguments[0];else{if(!arguments[0]||!arguments[0].number)return new hand;c.push(arguments[0])}else c=arguments;for(var i=0;i<c.length;i++){if(!c[i].number)return new hand(a);b.push(c[i]),a.push(c[i]),this.length++}}return new hand(a)}},this.removeCards=function(){if(arguments.length>0){var a=new hand,c=[];if("number"==typeof arguments[0]){arguments[1]||g(b);for(var d=0;d<arguments[0];d++)a.addCards(b.pop());arguments[1]||f(b)}else{var e={};if(1==arguments.length)if(arguments[0]&&arguments[0].toArray)c=arguments[0].toArray();else if(arguments[0]&&arguments[0].length)c=arguments[0];else{if(!arguments[0]||!arguments[0].number)return new hand;c.push(arguments[0])}else c=arguments;for(var d=0;d<c.length;d++)e[13*c[d].type+c[d].number]=[c[d],0];for(var h=0;h<b.length;h++)e[13*b[h].type+b[h].number]&&(e[13*b[h].type+b[h].number][1]++,b.splice(h,1),h--);for(d=0;d<c.length;d++)for(var i=0;i<e[13*c[d].type+c[d].number][1];i++)a.addCards(e[13*c[d].type+c[d].number][0])}return this.length=b.length,a}},this.sort=function(a){return f(b),a&&b.reverse(),this.show()},this.removeDup=function(){return f(b,!0),this.length=b.length,b},this.shuffle=function(){return g(b),this.show()},this.searchCard=function(a){for(var c=0;c<b.length;c++)if(b[c].type==a.type&&b[c].number==a.number)return!0;return!1},this.check=function(){if(5==b.length){var a=h(b);return b=a.toArray(),console.log(rules[a.rank]),this.show()}},this.c5=function(){return b=d(),this.show()},this.sortT=function(){return e(b),this.show()},this.keyMap=function(){var a=new hand,c=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],d=[{0:0,n:[]},{0:0,n:[]},{0:0,n:[]},{0:0,n:[]},{0:0,n:[]}],f=[[0],[0],[0],[0],[0]];a.addCards(b),a=a.removeDup();for(var g=0;g<a.length;g++)c[a[g].number-1][a[g].type]=a[g],++c[a[g].number-1][5]||(c[a[g].number-1][5]=1),f[a[g].type].push(a[g].number),f[a[g].type][0]++;for(var g=0;g<c.length;g++)"number"!=typeof c[g][5]&&(c[g][5]=0),d[c[g][5]][0]++,d[c[g][5]].n.push(g);return{ns:c,ts:f,m:d}},a)if(a.toArray)var b=a.toArray();else"number"==typeof a?this.addCards(a):a.length&&(b=a,i(),this.length=b.length)}function deck(a,b){function d(a){for(var b=[],c=0;4>c;c++)for(var d=1;14>d;d++)b.push(new card(c,d));return a&&(b.push(new card(4,1)),b.push(new card(4,2))),b}function e(a,b,c){"number"==typeof c?b.addCards(a.removeCards(c).toArray()):a.searchCard(c)?b.addCards(a.removeCards(c).toArray()):console.log(c.typeName+" "+c.name+" not found.")}function f(a,b){b=isNaN(b)?1:parseInt(b),e(c.deck,a,b)}function g(a){for(var d=2==arguments.length&&arguments[1].length?[null].concat(arguments[1]):arguments,f=1;f<d.length;f++)e(a,c.field,d[f])}function h(a){for(var d=2==arguments.length&&arguments[1].length?[null].concat(arguments[1]):arguments,f=1;f<d.length;f++)e(a,c.discardD,d[f])}function i(a){for(var d=2==arguments.length&&arguments[1].length?[null].concat(arguments[1]):arguments,f=1;f<d.length;f++)e(c.discardD,a,d[f])}var c=this;this.createDeck=function(){this.deck=new hand(d())},this.addPlayer=function(a){a=a.toString(),this.players[a]=new hand,this.players[a].draw=function(b){f(c.players[a],b)},this.players[a].play=function(b){g(c.players[a],b)},this.players[a].discard=function(b){h(c.players[a],b)},this.players[a].restore=function(b){i(c.players[a],b)}},this.removePlayer=function(a){a=a.toString(),this.players[a]&&(this.players[a].discard(c.players[a].toArray()),delete this.players[a])},this.deal=function(a,b){if(c.players[a]){if("number"==typeof b||c.deck.searchCard(b))return e(c.deck,c.players[a],b),b;if(b&&b.length){b.toArray&&(b=b.toArray());for(var d=0,f=0;f<b.length;f++)c.deck.searchCard(b)&&(e(c.deck,c.players[a],b),d++);return d}if("undefined"==typeof b)return e(c.deck,c.players[a],1),1}return 0},this.discard=function(a){h(c.deck,a)},this.restore=function(a){i(c.deck,a)},this.reset=function(){this.createDeck(),this.players={},this.field=new hand,this.discardD=new hand},this.setup=function(){if(b&&b.length){for(var c=new hand,d=0;d<b.length;d++)e(this.deck,c,b[d]);this.discardD=this.deck,this.deck=c}if("object"==typeof a&&a.length)for(var f=0;f<a.length;f++)this.addPlayer(a[f]);else"string"==typeof a&&this.addPlayer(a)},this.clearPlaying=function(){this.discardD.addCards(c.field.toArray()),this.field=new hand},this.reset(),this.setup()}function chance(a,b){this.p=b,this.t=a,this.chance=b/a;var c=String(Math.round(1e6*this.chance)/1e4);for(-1==c.indexOf(".")&&(c+=".");c.substr(c.indexOf(".")).length<5;)c+="0";for(;c.substr(0,c.indexOf(".")).length<3;)c=" "+c;for(a=String(a),b=String(b);b.length<a.length;)b=" "+b;this.show=function(){var d="["+b+"/"+a+"] probability: "+c+" %";return console.log(d),d}}function chancePrep(a,b){var e,f,h,d=new hand,g=new hand;return a.toArray?d.addCards(a.toArray()):d.addCards(a),b&&b.toArray?g.addCards(b.toArray()):g.addCards(b),d.addCards(a),d.removeDup(),g.removeDup(),d.removeCards([card(4,1),card(4,2)]),g.removeCards([card(4,1),card(4,2)]),g.length&&g.length<=5&&(h=g.keyMap(),d.removeCards(g.toArray())),f=d.keyMap(),e=g.length>4?1:combination(d.length,5-g.length),{t:e,n:f,n2:h,tmp:d,tmp2:g}}function nothingChance(a,b,c){var d=chancePrep(a,b,c),e=0,f=d.tmp,g=d.t,h=d.n,i=d.tmp2,j=d.n2,k=[];switch(i.length){case 0:if(h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>4){for(var l=0;l<h.ns.length;l++)k.push(h.ns[l][5]);e=cn(k,5),e-=flushChance(f).p,e-=straightChance(f).p,e-=sfChance(f).p}break;case 1:if(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>3){for(var l=0;l<h.ns.length;l++)l!=j.m[1].n[0]&&k.push(h.ns[l][5]);e=cn(k,4),e-=flushChance(f,i).p,e-=straightChance(f,i).p,e-=sfChance(f,i).p}break;case 2:if(!j.m[2][0]&&(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>2)){for(var l=0;l<h.ns.length;l++)l!=j.m[1].n[0]&&l!=j.m[1].n[1]&&k.push(h.ns[l][5]);e=cn(k,3),e-=flushChance(f,i).p,e-=straightChance(f,i).p,e-=sfChance(f,i).p}break;case 3:if(!j.m[2][0]&&!j.m[3][0]&&(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[h.ns[j.m[1].n[2]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1)){for(var l=0;l<h.ns.length;l++)l!=j.m[1].n[0]&&l!=j.m[1].n[1]&&l!=j.m[1].n[2]&&k.push(h.ns[l][5]);e=cn(k,2),e-=flushChance(f,i).p,e-=straightChance(f,i).p,e-=sfChance(f,i).p}break;case 4:j.m[2][0]||j.m[3][0]||j.m[4][0]||(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[h.ns[j.m[1].n[2]][5]][0]--,h.m[h.ns[j.m[1].n[3]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],e-=flushChance(f,i).p,e-=straightChance(f,i).p,e-=sfChance(f,i).p));break;case 5:5==j.m[1][0]&&(e=1,e-=flushChance(f,i).p,e-=straightChance(f,i).p,e-=sfChance(f,i).p)}return new chance(g,e)}function pairChance(a,b,c){var d=chancePrep(a,b,c),e=0,g=(d.tmp,d.t),h=d.n,i=d.tmp2,j=d.n2;switch(i.length){case 0:h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>3&&h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[4][0]*combination(4,2)*(combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1),3)-(h.m[4][0]-1)*combination(4,3)-h.m[3][0]*combination(3,3)-(h.m[4][0]-1)*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-2))-h.m[3][0]*combination(3,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*(h.m[4][0]-1))-h.m[2][0]*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*(h.m[4][0]-1))),e+=h.m[3][0]*combination(3,2)*(combination(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0],3)-h.m[4][0]*combination(4,3)-(h.m[3][0]-1)*combination(3,3)-h.m[4][0]*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*(h.m[4][0]-1))-(h.m[3][0]-1)*combination(3,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-2)+4*h.m[4][0])-h.m[2][0]*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*(h.m[3][0]-1)+4*h.m[4][0])),e+=h.m[2][0]*combination(2,2)*(combination(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*h.m[4][0],3)-h.m[4][0]*combination(4,3)-h.m[3][0]*combination(3,3)-h.m[4][0]*combination(4,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*(h.m[4][0]-1))-h.m[3][0]*combination(3,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*(h.m[3][0]-1)+4*h.m[4][0])-(h.m[2][0]-1)*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-2)+3*h.m[3][0]+4*h.m[4][0])));break;case 1:c2=h.ns[j.m[1].n[0]][5],(0==c2&&h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>2&&h.m[2][0]+h.m[3][0]+h.m[4][0]>0||c2>0&&h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>3)&&(h.m[c2][0]--,e+=h.m[4][0]*combination(4,2)*(combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1),2)-(h.m[4][0]-1)*combination(4,2)-h.m[3][0]*combination(3,2)-h.m[2][0]*combination(2,2)),e+=h.m[3][0]*combination(3,2)*(combination(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-(h.m[3][0]-1)*combination(3,2)-h.m[2][0]*combination(2,2)),e+=h.m[2][0]*combination(2,2)*(combination(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-h.m[3][0]*combination(3,2)-(h.m[2][0]-1)*combination(2,2)),e+=combination(c2,1)*(combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],3)-h.m[4][0]*combination(4,3)-h.m[3][0]*combination(3,3)-h.m[4][0]*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1))-h.m[3][0]*combination(3,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0])-h.m[2][0]*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*h.m[4][0])));break;case 2:j.m[2][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>2&&(e+=combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],3)-h.m[4][0]*combination(4,3)-h.m[3][0]*combination(3,3)-h.m[4][0]*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1))-h.m[3][0]*combination(3,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0])-h.m[2][0]*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*h.m[4][0]))):(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&h.m[2][0]+h.m[3][0]+h.m[4][0]+h.ns[j.m[1].n[0]][5]+h.ns[j.m[1].n[1]][5]>0&&(e+=h.m[4][0]*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1)),e+=h.m[3][0]*combination(3,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0]),e+=h.m[2][0]*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*h.m[4][0]),e+=h.ns[j.m[1].n[0]][5]*(combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-h.m[3][0]*combination(3,2)-h.m[2][0]*combination(2,2)),e+=h.ns[j.m[1].n[1]][5]*(combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-h.m[3][0]*combination(3,2)-h.m[2][0]*combination(2,2))));break;case 3:j.m[2][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&(e+=combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-h.m[3][0]*combination(3,2)-h.m[2][0]*combination(2,2))):j.m[1][0]&&(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[h.ns[j.m[1].n[2]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&h.m[2][0]+h.m[3][0]+h.m[4][0]+h.ns[j.m[1].n[0]][5]+h.ns[j.m[1].n[1]][5]+h.ns[j.m[1].n[2]][5]>0&&(e+=h.m[4][0]*combination(4,2)+h.m[3][0]*combination(3,2)+h.m[2][0]*combination(2,2),e+=h.ns[j.m[1].n[0]][5]*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])+h.ns[j.m[1].n[1]][5]*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])+h.ns[j.m[1].n[2]][5]*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])));break;case 4:j.m[4][0]||j.m[3][0]||j.m[2][0]>1||(j.m[2][0]&&j.m[1][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])):(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[h.ns[j.m[1].n[2]][5]][0]--,h.m[h.ns[j.m[1].n[3]][5]][0]--,h.ns[j.m[1].n[0]][5]+h.ns[j.m[1].n[1]][5]+h.ns[j.m[1].n[2]][5]+h.ns[j.m[1].n[3]][5]>0&&(e+=h.ns[j.m[1].n[0]][5]+h.ns[j.m[1].n[1]][5]+h.ns[j.m[1].n[2]][5]+h.ns[j.m[1].n[3]][5])));break;case 5:3==j.m[1][0]&&1==j.m[2][0]&&(e=1)}return new chance(g,e)}function tpChance(a,b,c){var d=chancePrep(a,b,c),e=0,g=(d.tmp,d.t),h=d.n,i=d.tmp2,j=d.n2;switch(i.length){case 0:h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>2&&h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&(e+=combination(h.m[2][0],2)*combination(2,2)*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-2)+3*h.m[3][0]+4*h.m[4][0]),e+=h.m[2][0]*h.m[3][0]*combination(2,2)*combination(3,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*(h.m[3][0]-1)+4*h.m[4][0]),e+=h.m[2][0]*h.m[4][0]*combination(2,2)*combination(4,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*(h.m[4][0]-1)),e+=combination(h.m[3][0],2)*combination(3,2)*combination(3,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-2)+4*h.m[4][0]),e+=h.m[3][0]*h.m[4][0]*combination(3,2)*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*(h.m[4][0]-1)),e+=combination(h.m[4][0],2)*combination(4,2)*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-2)));break;case 1:h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&(!h.ns[j.m[1].n[0]][5]&&h.m[2][0]+h.m[3][0]+h.m[4][0]>1||h.ns[j.m[1].n[0]][5]&&h.m[2][0]+h.m[3][0]+h.m[4][0]>0)&&(e+=combination(h.m[2][0],2)*combination(2,2)*combination(2,2),e+=h.m[2][0]*h.m[3][0]*combination(2,2)*combination(3,2),e+=h.m[2][0]*h.m[4][0]*combination(2,2)*combination(4,2),e+=combination(h.m[3][0],2)*combination(3,2)*combination(3,2),e+=h.m[3][0]*h.m[4][0]*combination(3,2)*combination(4,2),e+=combination(h.m[4][0],2)*combination(4,2)*combination(4,2),e+=h.ns[j.m[1].n[0]][5]*(h.m[4][0]*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1))+h.m[3][0]*combination(3,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0])+h.m[2][0]*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*h.m[4][0])));break;case 2:j.m[2][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[4][0]*combination(4,2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1)),e+=h.m[3][0]*combination(3,2)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0]),e+=h.m[2][0]*combination(2,2)*(h.m[1][0]+2*(h.m[2][0]-1)+3*h.m[3][0]+4*h.m[4][0]))):h.ns[j.m[1].n[0]][5]+h.ns[j.m[1].n[1]][5]>0&&(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(h.ns[j.m[1].n[0]][5]*h.ns[j.m[1].n[0]][5]||h.m[2][0]+h.m[3][0]+h.m[4][0]>0)&&(e+=h.ns[j.m[1].n[0]][5]*h.ns[j.m[1].n[1]][5]*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0]),e+=h.ns[j.m[1].n[0]][5]*(h.m[4][0]*combination(4,2)+h.m[3][0]*combination(3,2)+h.m[2][0]*combination(2,2)),e+=h.ns[j.m[1].n[1]][5]*(h.m[4][0]*combination(4,2)+h.m[3][0]*combination(3,2)+h.m[2][0]*combination(2,2))));break;case 3:j.m[2][0]?(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(h.ns[j.m[1].n[0]][5]||h.m[2][0]+h.m[3][0]+h.m[4][0]>0)&&(e+=h.m[4][0]*combination(4,2)+h.m[3][0]*combination(3,2)+h.m[2][0]*combination(2,2),e+=h.ns[j.m[1].n[0]][5]*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0]))):j.m[1][0]&&(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[h.ns[j.m[1].n[2]][5]][0]--,(h.ns[j.m[1].n[0]][5]&&h.ns[j.m[1].n[1]][5]||h.ns[j.m[1].n[0]][5]&&h.ns[j.m[1].n[2]][5]||h.ns[j.m[1].n[1]][5]&&h.ns[j.m[1].n[2]][5])&&(e+=h.ns[j.m[1].n[0]][5]*h.ns[j.m[1].n[1]][5]+h.ns[j.m[1].n[0]][5]*h.ns[j.m[1].n[2]][5]+h.ns[j.m[1].n[1]][5]*h.ns[j.m[1].n[2]][5]));break;case 4:2==j.m[2][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[2].n[1]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])):j.m[2][0]&&j.m[1][0]&&(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,(h.ns[j.m[1].n[0]][5]||h.ns[j.m[1].n[1]][5])&&(e+=h.ns[j.m[1].n[0]][5]+h.ns[j.m[1].n[1]][5]));break;case 5:2==j.m[2][0]&&1==j.m[1][0]&&(e=1)}return new chance(g,e)}function toakChance(a,b,c){var d=chancePrep(a,b,c),e=0,g=(d.tmp,d.t),h=d.n,i=d.tmp2,j=d.n2;switch(i.length){case 0:h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>2&&(h.m[3][0]||h.m[4][0])&&(e+=h.m[4][0]*combination(4,3)*(combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1),2)-(h.m[4][0]-1)*combination(4,2)-h.m[3][0]*combination(3,2)-h.m[2][0]*combination(2,2)),e+=h.m[3][0]*combination(3,3)*(combination(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-(h.m[3][0]-1)*combination(3,2)-h.m[2][0]*combination(2,2)));break;case 1:h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&(h.ns[j.m[1].n[0]][5]>1||h.m[3][0]||h.m[4][0])&&(e+=h.m[4][0]*combination(4,3)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1)),e+=h.m[3][0]*combination(3,3)*(h.m[1][0]+2*h.m[2][0]+3*(h.m[3][0]-1)+4*h.m[4][0]),e+=combination(h.ns[j.m[1].n[0]][5],2)*(combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-h.m[3][0]*combination(3,2)-h.m[2][0]*combination(2,2)));break;case 2:j.m[2][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.ns[j.m[2].n[0]][5]&&h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&(e+=h.ns[j.m[2].n[0]][5]*(combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-h.m[3][0]*combination(3,2)-h.m[2][0]*combination(2,2)))):(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(h.ns[j.m[1].n[0]][5]>1||h.ns[j.m[1].n[1]][5]>1||h.m[3][0]||h.m[4][0])&&(e+=h.m[4][0]*combination(4,3),e+=h.m[3][0]*combination(3,3),e+=combination(h.ns[j.m[1].n[0]][5],2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0]),e+=combination(h.ns[j.m[1].n[1]][5],2)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])));break;case 3:j.m[3][0]?(h.m[h.ns[j.m[3].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&(e+=combination(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0],2)-h.m[4][0]*combination(4,2)-h.m[3][0]*combination(3,2)-h.m[2][0]*combination(2,2))):j.m[2][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,h.ns[j.m[2].n[0]][5]>0&&h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.ns[j.m[2].n[0]][5]*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0]))):(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.m[h.ns[j.m[1].n[2]][5]][0]--,(h.ns[j.m[1].n[0]][5]>1||h.ns[j.m[1].n[1]][5]>1||h.ns[j.m[1].n[2]][5]>1)&&(e+=combination(h.ns[j.m[1].n[0]][5],2)+combination(h.ns[j.m[1].n[1]][5],2)+combination(h.ns[j.m[1].n[2]][5],2)));break;case 4:j.m[3][0]?(h.m[h.ns[j.m[3].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])):j.m[2][0]&&j.m[1][0]&&(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.ns[j.m[2].n[0]][5]&&(e+=h.ns[j.m[2].n[0]][5]));break;case 5:j.m[3][0]&&j.m[1][0]&&(e=1)}return new chance(g,e)}function straightChance(a,b,c){var d=chancePrep(a,b,c),e=0,f=d.tmp,g=d.t,h=d.n,i=d.tmp2,j=d.n2;switch(i.length){case 0:for(var k=0;10>k;k++)e+=h.ns[k][5]*h.ns[k+1][5]*h.ns[k+2][5]*h.ns[k+3][5]*h.ns[k+4>12?0:k+4][5];e-=sfChance(f).p;break;case 1:h.ns[j.m[1].n[0]][5]=1;for(var k=j.m[1].n[0]-4<0?0:j.m[1].n[0]-4;k<(j.m[1].n[0]>9?10:j.m[1].n[0]+1);k++)e+=h.ns[k][5]*h.ns[k+1][5]*h.ns[k+2][5]*h.ns[k+3][5]*h.ns[k+4>12?0:k+4][5],0==k&&(e+=h.ns[0][5]*h.ns[9][5]*h.ns[10][5]*h.ns[11][5]*h.ns[12][5]);e-=sfChance(f,i).p;break;case 2:if(!j.m[2][0]&&(Math.abs(j.m[1].n[0]-j.m[1].n[1])<5||0==j.m[1].n[0]&&j.m[1].n[1]>8)){h.ns[j.m[1].n[0]][5]=1,h.ns[j.m[1].n[1]][5]=1;for(var k=j.m[1].n[1]-4<0?0:j.m[1].n[1]-4;k<(j.m[1].n[0]>9?10:0==j.m[1].n[0]?j.m[1].n[1]+1:j.m[1].n[0]+1);k++)(j.m[1].n[0]>=k&&j.m[1].n[0]<=k+4||9==k&&0==j.m[1].n[0])&&j.m[1].n[1]>=k&&j.m[1].n[1]<=k+4&&(e+=h.ns[k][5]*h.ns[k+1][5]*h.ns[k+2][5]*h.ns[k+3][5]*h.ns[k+4>12?0:k+4][5]),0==k&&(0==j.m[1].n[0]||j.m[1].n[0]>8&&j.m[1].n[0]<13)&&(0==j.m[1].n[1]||j.m[1].n[1]>8&&j.m[1].n[1]<13)&&(e+=h.ns[0][5]*h.ns[9][5]*h.ns[10][5]*h.ns[11][5]*h.ns[12][5]);e-=sfChance(f,i).p}break;case 3:if(!j.m[3][0]&&!j.m[2][0]&&(Math.abs(j.m[1].n[0]-j.m[1].n[2])<5||0==j.m[1].n[0]&&j.m[1].n[1]>8)){h.ns[j.m[1].n[0]][5]=1,h.ns[j.m[1].n[1]][5]=1,h.ns[j.m[1].n[2]][5]=1;for(var k=j.m[1].n[1]-4<0?0:j.m[1].n[1]-4;k<(j.m[1].n[0]>9?10:0==j.m[1].n[0]?j.m[1].n[1]+1:j.m[1].n[0]+1);k++)(j.m[1].n[0]>=k&&j.m[1].n[0]<=k+4||9==k&&0==j.m[1].n[0])&&j.m[1].n[1]>=k&&j.m[1].n[1]<=k+4&&j.m[1].n[2]>=k&&j.m[1].n[2]<=k+4&&(e+=h.ns[k][5]*h.ns[k+1][5]*h.ns[k+2][5]*h.ns[k+3][5]*h.ns[k+4>12?0:k+4][5]),0==k&&(0==j.m[1].n[0]||j.m[1].n[0]>8&&j.m[1].n[0]<13)&&(0==j.m[1].n[1]||j.m[1].n[1]>8&&j.m[1].n[1]<13)&&(0==j.m[1].n[2]||j.m[1].n[2]>8&&j.m[1].n[2]<13)&&(e+=h.ns[0][5]*h.ns[9][5]*h.ns[10][5]*h.ns[11][5]*h.ns[12][5]);e-=sfChance(f,i).p}break;case 4:if(!j.m[4][0]&&!j.m[3][0]&&!j.m[2][0]&&(Math.abs(j.m[1].n[0]-j.m[1].n[3])<5||0==j.m[1].n[0]&&j.m[1].n[1]>8)){h.ns[j.m[1].n[0]][5]=1,h.ns[j.m[1].n[1]][5]=1,h.ns[j.m[1].n[2]][5]=1,h.ns[j.m[1].n[3]][5]=1;for(var k=j.m[1].n[1]-4<0?0:j.m[1].n[1]-4;k<(j.m[1].n[0]>9?10:0==j.m[1].n[0]?j.m[1].n[1]+1:j.m[1].n[0]+1);k++)(j.m[1].n[0]>=k&&j.m[1].n[0]<=k+4||9==k&&0==j.m[1].n[0])&&j.m[1].n[1]>=k&&j.m[1].n[1]<=k+4&&j.m[1].n[2]>=k&&j.m[1].n[2]<=k+4&&j.m[1].n[3]>=k&&j.m[1].n[3]<=k+4&&(e+=h.ns[k][5]*h.ns[k+1][5]*h.ns[k+2][5]*h.ns[k+3][5]*h.ns[k+4>12?0:k+4][5]),0==k&&(0==j.m[1].n[0]||j.m[1].n[0]>8&&j.m[1].n[0]<13)&&(0==j.m[1].n[1]||j.m[1].n[1]>8&&j.m[1].n[1]<13)&&(0==j.m[1].n[2]||j.m[1].n[2]>8&&j.m[1].n[2]<13)&&(0==j.m[1].n[3]||j.m[1].n[3]>8&&j.m[1].n[3]<13)&&(e+=h.ns[0][5]*h.ns[9][5]*h.ns[10][5]*h.ns[11][5]*h.ns[12][5]);e-=sfChance(f,i).p}break;case 5:j.m[4][0]||j.m[3][0]||j.m[2][0]||!(Math.abs(j.m[1].n[0]-j.m[1].n[3])<5||0==j.m[1].n[0]&&j.m[1].n[1]>8)||(e=1,e-=sfChance(f,i).p)}return new chance(g,e)}function flushChance(a,b,c){var d=chancePrep(a,b,c),e=0,f=d.tmp,g=d.t,h=d.n,i=d.tmp2;switch(d.n2,i.length){case 0:(h.ts[0][0]>4||h.ts[1][0]>4||h.ts[2][0]>4||h.ts[3][0]>4)&&(e+=combination(h.ts[0][0],5)+combination(h.ts[1][0],5)+combination(h.ts[2][0],5)+combination(h.ts[3][0],5),e-=sfChance(f).p);break;case 1:h.ts[i.toArray()[0].type][0]>3&&(e+=combination(h.ts[i.toArray()[0].type][0],4),e-=sfChance(f,i).p);break;case 2:i.toArray()[0].type==i.toArray()[1].type&&h.ts[i.toArray()[0].type][0]>2&&(e+=combination(h.ts[i.toArray()[0].type][0],3),e-=sfChance(f,i).p);break;case 3:i.toArray()[0].type==i.toArray()[1].type&&i.toArray()[1].type==i.toArray()[2].type&&h.ts[i.toArray()[0].type][0]>1&&(e+=combination(h.ts[i.toArray()[0].type][0],2),e-=sfChance(f,i).p);break;case 4:i.toArray()[0].type==i.toArray()[1].type&&i.toArray()[1].type==i.toArray()[2].type&&i.toArray()[2].type==i.toArray()[3].type&&h.ts[i.toArray()[0].type][0]>0&&(e+=h.ts[i.toArray()[0].type][0],e-=sfChance(f,i).p);break;case 5:i.toArray()[0].type==i.toArray()[1].type&&i.toArray()[1].type==i.toArray()[2].type&&i.toArray()[2].type==i.toArray()[3].type&&i.toArray()[3].type==i.toArray()[4].type&&(e=1,e-=sfChance(f,i).p)}return new chance(g,e)}function fhChance(a,b,c){var d=chancePrep(a,b,c),e=0,g=(d.tmp,d.t),h=d.n,i=d.tmp2,j=d.n2;switch(i.length){case 0:h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&h.m[3][0]+h.m[4][0]>0&&(e+=h.m[4][0]*combination(4,3)*((h.m[4][0]-1)*combination(4,2)+h.m[3][0]*combination(3,2)+h.m[2][0]*combination(2,2)),e+=h.m[3][0]*combination(3,3)*(h.m[4][0]*combination(4,2)+(h.m[3][0]-1)*combination(3,2)+h.m[2][0]*combination(2,2)));break;case 1:h.m[h.ns[j.m[1].n[0]][5]][0]--,(1==h.ns[j.m[1].n[0]][5]&&h.m[3][0]+h.m[4][0]>0||h.ns[j.m[1].n[0]][5]>1&&h.m[2][0]+h.m[3][0]+h.m[4][0]>0)&&(e+=combination(h.ns[j.m[1].n[0]][5],2)*(h.m[4][0]*combination(4,2)+h.m[3][0]*combination(3,2)+h.m[2][0]*combination(2,2)),e+=combination(h.ns[j.m[1].n[0]][5],1)*(h.m[4][0]*combination(4,3)+h.m[3][0]*combination(3,3)));break;case 2:j.m[2][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,(h.ns[j.m[2].n[0]][5]&&h.m[2][0]+h.m[3][0]+h.m[4][0]>0||h.m[3][0]+h.m[4][0]>0)&&(e+=h.m[4][0]*combination(4,3)+h.m[3][0]*combination(3,3),e+=h.ns[j.m[2].n[0]][5]*(h.m[4][0]*combination(4,2)+h.m[3][0]*combination(3,2)+h.m[2][0]*combination(2,2)))):(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,h.ns[j.m[1].n[0]][5]*h.ns[j.m[1].n[1]][5]>1&&(e+=combination(h.ns[j.m[1].n[0]][5],2)*h.ns[j.m[1].n[1]][5],e+=combination(h.ns[j.m[1].n[1]][5],2)*h.ns[j.m[1].n[0]][5]));break;case 3:j.m[3][0]?(h.m[h.ns[j.m[3].n[0]][5]][0]--,h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[4][0]*combination(4,2)+h.m[3][0]*combination(3,2)+h.m[2][0]*combination(2,2))):j.m[2][0]&&(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,(h.ns[j.m[2].n[0]][5]&&h.ns[j.m[1].n[0]][5]||h.ns[j.m[1].n[0]][5]>1)&&(e+=h.ns[j.m[2].n[0]][5]*h.ns[j.m[1].n[0]][5],e+=combination(h.ns[j.m[1].n[0]][5],2)));break;case 4:j.m[3][0]?(h.m[h.ns[j.m[3].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,h.ns[j.m[1].n[0]][5]&&(e+=h.ns[j.m[1].n[0]][5])):2==j.m[2][0]&&(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[2].n[1]][5]][0]--,(h.ns[j.m[2].n[0]][5]||h.ns[j.m[2].n[1]][5])&&(e+=h.ns[j.m[2].n[0]][5]+h.ns[j.m[2].n[1]][5]));break;case 5:j.m[3][0]&&j.m[2][0]&&(e=1)}return new chance(g,e)}function foakChance(a,b,c){var d=chancePrep(a,b,c),e=0,g=(d.tmp,d.t),h=d.n,i=d.tmp2,j=d.n2;switch(i.length){case 0:h.m[4][0]&&h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>1&&(e+=h.m[4][0]*combination(4,4)*(h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*(h.m[4][0]-1)));break;case 1:h.m[h.ns[j.m[1].n[0]][5]][0]--,3==h.ns[j.m[1].n[0]][5]&&h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0]),h.m[4][0]>0&&(e+=h.m[4][0]);break;case 2:j.m[2][0]?(h.m[h.ns[j.m[2].n[0]][5]][0]--,2==h.ns[j.m[2].n[0]][5]&&h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])):(h.m[h.ns[j.m[1].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[1]][5]][0]--,(3==h.ns[j.m[1].n[0]][5]||3==h.ns[j.m[1].n[1]][5])&&(e+=combination(h.ns[j.m[1].n[0]][5],3)+combination(h.ns[j.m[1].n[1]][5],3)));
break;case 3:j.m[3][0]?(h.m[h.ns[j.m[3].n[0]][5]][0]--,1==h.ns[j.m[3].n[0]][5]&&h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])):j.m[2][0]&&(h.m[h.ns[j.m[2].n[0]][5]][0]--,h.m[h.ns[j.m[1].n[0]][5]][0]--,2==h.ns[j.m[2].n[0]][5]&&(e=1));break;case 4:j.m[4][0]?(h.m[h.ns[j.m[4].n[0]][5]][0]--,h.m[1][0]+h.m[2][0]+h.m[3][0]+h.m[4][0]>0&&(e+=h.m[1][0]+2*h.m[2][0]+3*h.m[3][0]+4*h.m[4][0])):j.m[3][0]&&1==h.ns[j.m[3].n[0]][5]&&(e=1);break;case 5:j.m[4][0]&&(e=1)}return new chance(g,e)}function sfChance(a,b,c){var d=chancePrep(a,b,c),e=0,g=(d.tmp,d.t),h=d.n,i=d.tmp2,j=d.n2;switch(i.length){case 0:if(h.ts[0][0]>4||h.ts[1][0]>4||h.ts[2][0]>4||h.ts[3][0]>4)for(var k=0;4>k;k++)for(var l=1;l<h.ts[k].length-3;l++)h.ts[k][l]==h.ts[k][l+1]-1&&h.ts[k][l+1]-1==h.ts[k][l+2]-2&&h.ts[k][l+2]-2==h.ts[k][l+3]-3&&h.ts[k][l+3]-3==(l+4>=h.ts[k].length?h.ts[k][1]+9:h.ts[k][l+4]-4)&&e++;break;case 1:var k=i.toArray()[0].type;if(h.ts[k][0]>3){for(var m=1,n=1;m<h.ts[k].length&&n<j.ts[k].length;m++)h.ts[k][m]>j.ts[k][n]&&(h.ts[k].splice(m,0,j.ts[k][n]),h.ts[k][0]++,n++);for(var l=n;l<j.ts[k].length;l++)h.ts[k].push(j.ts[k][l]),h.ts[k][0]++;for(var l=1;l<h.ts[k].length-3;l++)h.ts[k][l]!=h.ts[k][l+1]-1||h.ts[k][l+1]-1!=h.ts[k][l+2]-2||h.ts[k][l+2]-2!=h.ts[k][l+3]-3||h.ts[k][l+3]-3!=(l+4>=h.ts[k].length?h.ts[k][1]+9:h.ts[k][l+4]-4)||j.ts[k][1]!=h.ts[k][l]&&j.ts[k][1]!=h.ts[k][l+1]&&j.ts[k][1]!=h.ts[k][l+2]&&j.ts[k][1]!=h.ts[k][l+3]&&j.ts[k][1]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||e++}break;case 2:if(i.toArray()[0].type==i.toArray()[1].type&&h.ts[i.toArray()[0].type][0]>2){var k=i.toArray()[0].type;if(h.ts[k][0]>2){for(var m=1,n=1;m<h.ts[k].length&&n<j.ts[k].length;m++)h.ts[k][m]>j.ts[k][n]&&(h.ts[k].splice(m,0,j.ts[k][n]),h.ts[k][0]++,n++);for(var l=n;l<j.ts[k].length;l++)h.ts[k].push(j.ts[k][l]),h.ts[k][0]++;for(var l=1;l<h.ts[k].length-3;l++)h.ts[k][l]!=h.ts[k][l+1]-1||h.ts[k][l+1]-1!=h.ts[k][l+2]-2||h.ts[k][l+2]-2!=h.ts[k][l+3]-3||h.ts[k][l+3]-3!=(l+4>=h.ts[k].length?h.ts[k][1]+9:h.ts[k][l+4]-4)||j.ts[k][1]!=h.ts[k][l]&&j.ts[k][1]!=h.ts[k][l+1]&&j.ts[k][1]!=h.ts[k][l+2]&&j.ts[k][1]!=h.ts[k][l+3]&&j.ts[k][1]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||j.ts[k][2]!=h.ts[k][l]&&j.ts[k][2]!=h.ts[k][l+1]&&j.ts[k][2]!=h.ts[k][l+2]&&j.ts[k][2]!=h.ts[k][l+3]&&j.ts[k][2]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||e++}}break;case 3:if(i.toArray()[0].type==i.toArray()[1].type&&i.toArray()[1].type==i.toArray()[2].type&&h.ts[i.toArray()[0].type][0]>1){var k=i.toArray()[0].type;if(h.ts[k][0]>1){for(var m=1,n=1;m<h.ts[k].length&&n<j.ts[k].length;m++)h.ts[k][m]>j.ts[k][n]&&(h.ts[k].splice(m,0,j.ts[k][n]),h.ts[k][0]++,n++);for(var l=n;l<j.ts[k].length;l++)h.ts[k].push(j.ts[k][l]),h.ts[k][0]++;for(var l=1;l<h.ts[k].length-3;l++)h.ts[k][l]!=h.ts[k][l+1]-1||h.ts[k][l+1]-1!=h.ts[k][l+2]-2||h.ts[k][l+2]-2!=h.ts[k][l+3]-3||h.ts[k][l+3]-3!=(l+4>=h.ts[k].length?h.ts[k][1]+9:h.ts[k][l+4]-4)||j.ts[k][1]!=h.ts[k][l]&&j.ts[k][1]!=h.ts[k][l+1]&&j.ts[k][1]!=h.ts[k][l+2]&&j.ts[k][1]!=h.ts[k][l+3]&&j.ts[k][1]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||j.ts[k][2]!=h.ts[k][l]&&j.ts[k][2]!=h.ts[k][l+1]&&j.ts[k][2]!=h.ts[k][l+2]&&j.ts[k][2]!=h.ts[k][l+3]&&j.ts[k][2]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||j.ts[k][3]!=h.ts[k][l]&&j.ts[k][3]!=h.ts[k][l+1]&&j.ts[k][3]!=h.ts[k][l+2]&&j.ts[k][3]!=h.ts[k][l+3]&&j.ts[k][3]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||e++}}break;case 4:if(i.toArray()[0].type==i.toArray()[1].type&&i.toArray()[1].type==i.toArray()[2].type&&i.toArray()[2].type==i.toArray()[3].type&&h.ts[i.toArray()[0].type][0]>0){var k=i.toArray()[0].type;if(h.ts[k][0]){for(var m=1,n=1;m<h.ts[k].length&&n<j.ts[k].length;m++)h.ts[k][m]>j.ts[k][n]&&(h.ts[k].splice(m,0,j.ts[k][n]),h.ts[k][0]++,n++);for(var l=n;l<j.ts[k].length;l++)h.ts[k].push(j.ts[k][l]),h.ts[k][0]++;for(var l=1;l<h.ts[k].length-3;l++)h.ts[k][l]!=h.ts[k][l+1]-1||h.ts[k][l+1]-1!=h.ts[k][l+2]-2||h.ts[k][l+2]-2!=h.ts[k][l+3]-3||h.ts[k][l+3]-3!=(l+4>=h.ts[k].length?h.ts[k][1]+9:h.ts[k][l+4]-4)||j.ts[k][1]!=h.ts[k][l]&&j.ts[k][1]!=h.ts[k][l+1]&&j.ts[k][1]!=h.ts[k][l+2]&&j.ts[k][1]!=h.ts[k][l+3]&&j.ts[k][1]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||j.ts[k][2]!=h.ts[k][l]&&j.ts[k][2]!=h.ts[k][l+1]&&j.ts[k][2]!=h.ts[k][l+2]&&j.ts[k][2]!=h.ts[k][l+3]&&j.ts[k][2]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||j.ts[k][3]!=h.ts[k][l]&&j.ts[k][3]!=h.ts[k][l+1]&&j.ts[k][3]!=h.ts[k][l+2]&&j.ts[k][3]!=h.ts[k][l+3]&&j.ts[k][3]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||j.ts[k][4]!=h.ts[k][l]&&j.ts[k][4]!=h.ts[k][l+1]&&j.ts[k][4]!=h.ts[k][l+2]&&j.ts[k][4]!=h.ts[k][l+3]&&j.ts[k][4]!=h.ts[k][l+4>=h.ts[k].length?1:l+4]||e++}}break;case 5:var k=i.toArray()[0].type;k==i.toArray()[1].type&&k==i.toArray()[2].type&&k==i.toArray()[3].type&&k==i.toArray()[4].type&&(j.ts[k][1]==j.ts[k][2]-1&&j.ts[k][2]==j.ts[k][3]-1&&j.ts[k][3]==j.ts[k][4]-1&&j.ts[k][4]==j.ts[k][5]-1||1==j.ts[k][1]&&10==j.ts[k][2]&&11==j.ts[k][3]&&12==j.ts[k][4]&&13==j.ts[k][5])&&(e=1)}return new chance(g,e)}function checkP(a,b){var c,d,e,f,g,h,i,j,k,l,m;return e=nothingChance(a,b),f=pairChance(a,b),g=tpChance(a,b),h=toakChance(a,b),i=straightChance(a,b),j=flushChance(a,b),k=fhChance(a,b),l=foakChance(a,b),m=sfChance(a,b),console.log("Cards:"),a.sort(),console.log("Straight Flush:"),m.show(),console.log("Four of a Kind:"),l.show(),console.log("Full House:"),k.show(),console.log("Flush:"),j.show(),console.log("Straight:"),i.show(),console.log("Three of a Kind:"),h.show(),console.log("Two Pair:"),g.show(),console.log("Pair:"),f.show(),console.log("Nothing:"),e.show(),c=e.p+f.p+g.p+h.p+i.p+j.p+k.p+l.p+m.p,d=m.t,[e,f,g,h,i,j,k,l,m,new chance(d,c)]}var types={0:"Spade",1:"Heart",2:"Diamond",3:"Club",4:"Joker"},rules={0:"Nothing",1:"Pair",2:"Two Pair",3:"Three of a Kind",4:"Straight",5:"Flush",6:"Full House",7:"Four of a Kind",8:"Straight Flush"};