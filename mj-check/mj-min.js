function cardGroupSetup(){for(var e=0;e<cards.length;e++)card_types[cards[e].type]=cards[e];for(e=0;e<groups.length;e++)group_types[groups[e].type]=groups[e]}function nm(e){var t,l,p,r,g,c=[[]];for(l=0;l<e.length;l++)c[0].push(0);for(l=0;l<e.length;l++){for(t=c.slice(),p=1;p<=e[l];p++)for(r=0;r<c.length;r++)g=c[r].slice(),g[l]=p,t.push(g);c=t}return c}function getGroupPair(e){for(var t,l=[],r=0;r<e.length;r++)e[r]<2||(p=[r,r],t=e.slice(),t[r]-=2,l.push({p:p,l:t}));return l}function getGroupTriple(e){for(var t,l,p=[],r=0;r<e.length;r++)e[r]<3||(t=[r,r,r],l=e.slice(),l[r]-=3,p.push({g:t,l:l}));return p}function getGroupFlush(e){for(var t,l,p=[],r=2;r<e.length;r++)e[r-2]&&e[r-1]&&e[r]&&(t=[r-2,r-1,r],l=e.slice(),l[r-2]--,l[r-1]--,l[r]--,p.push({g:t,l:l}));return p}function checkGroupChance(e){for(var t=0,l=0;l<e.length;l++)t+=e[l];if(3>t){var p=getGroupPair(e);return p.length?[{c:[],p:[p[0].p],l:p[0].l}]:[{c:[],p:[],l:e}]}if(3==t){var r,g=getGroupTriple(e).concat(getGroupFlush(e)),c=[],p=getGroupPair(e);if(g.length)for(l=0;l<g.length;l++)c.push({c:[g[l].g],p:[],l:g[l].l});return c.length?c:p.length?[{c:[],p:[p[0].p],l:p[0].l}]:[{c:[],p:[],l:e}]}if(4==t){var g=getGroupTriple(e).concat(getGroupFlush(e)),p=getGroupPair(e),c=[];if(1==p.length?c.push({c:[],p:[p[0].p],l:p[0].l}):2==p.length&&c.push({c:[],p:[p[0].p,p[1].p],l:e.map(function(){return 0})}),g.length)for(l=0;l<g.length;l++)c.push({c:[g[l].g],p:[],l:g[l].l});return c.length?c:[{c:[],p:[],l:e}]}var r,g=getGroupTriple(e).concat(getGroupFlush(e)),c=[];if(g.length){for(var l=0;l<g.length;l++){r=checkGroupChance(g[l].l);for(var n=0;n<r.length;n++)r[n].c.unshift(g[l].g.slice());c=c.concat(r)}return c}var p=getGroupPair(e);if(p.length){for(var a=[],o=e.slice(),l=0;l<p.length;l++)a.push(p[l].p),o[p[l].p[0]]-=2;return{c:[],p:a,l:o}}return[{c:[],p:[],l:e}]}function countCards(e){for(var t={w:[0,0,0,0,0,0,0,0,0],t:[0,0,0,0,0,0,0,0,0],s:[0,0,0,0,0,0,0,0,0],z:[0,0,0,0,0,0,0],h:[0,0,0,0,0,0,0,0]},l=0;l<e.length;l++){var p=e[l]/10<<0,r=e[l]%10;switch(p){case 1:t.w[r-1]++;break;case 2:t.t[r-1]++;break;case 3:t.s[r-1]++;break;case 4:t.z[r-1]++;break;case 5:t.h[r-1]++}}return t}function uniqueG(e){for(var t={},l=[],p=0;p<e.length;p++){var r=e[p].p.concat(e[p].c).sort(function(e,t){return e.join("").localeCompare(t.join(""))}),g=r.map(function(e){return e.join("")}).join(",");t.hasOwnProperty(g)||(t[g]=e[p])}for(var g in t)l.push(t[g]);return l}function setTypeG(e,t){for(var l=[],p=0;p<e.length;p++){for(var r=e[p].c.slice(),g=[],c=e[p].p.slice(),n=0;n<r.length;n++)for(var a=0;a<r[n].length;a++)r[n][a]+=t+1;for(var n=0;n<e[p].l.length;n++)for(var a=0;a<e[p].l[n];a++)g.push(n+t+1);for(var n=0;n<e[p].p.length;n++)for(var a=0;a<e[p].p[n].length;a++)c[n][a]+=t+1;l.push({c:r,p:c,l:g})}return l}function filSTG(e,t){var l={};for(var p in e)l[p]=setTypeG(e[p].slice(),t);return l}function filterG(e){for(var t={l0:[],l1:[],l11:[],l2:[],l22:[],l211:[]},l=0;l<e.length;l++){for(var p=0,r=e[l].l.slice(),g=e[l].p.slice(),c=[],n=0;n<r.length;n++)1==r[n]&&(p++,c.push(n));for(var n=0;n<g.length;n++)p+=2;4==p?2==g.length?t.l22.push(e[l]):1==g.length&&(c[1]-c[0]>2||t.l211.push(e[l])):2==p?1==g.length?t.l2.push(e[l]):c[1]-c[0]>2||t.l11.push(e[l]):1==p?t.l1.push(e[l]):0==p&&t.l0.push(e[l])}return t}function checkAll(e){for(var t=countCards(e),l=filSTG(filterG(uniqueG(checkGroupChance(t.w))),10),p=filSTG(filterG(uniqueG(checkGroupChance(t.t))),20),r=filSTG(filterG(uniqueG(checkGroupChance(t.s))),30),g=[{c:[],p:[],l:t.z.slice()}],c={g:[],l:[]},n=[],a=0;a<t.z.length;a++)t.z[a]<3?2==t.z[a]&&(g[0].p.push([a,a]),g[0].l[a]-=2):(g[0].c.push([a,a,a]),g[0].l[a]-=3);if(g=filSTG(filterG(g),40),g.l11=[],g.l211=[],t.h[0]&&t.h[1]&&t.h[2]&&t.h[3])c.g.push([51,52,53,54]);else for(var a=0;4>a;a++)t.h[a]&&c.l.push(a+51);if(t.h[4]&&t.h[5]&&t.h[6]&&t.h[7])c.g.push([55,56,57,58]);else for(var a=4;8>a;a++)t.h[a]&&c.l.push(a+51);var o={l0:[],l14:[],l2:[]};if(l.l0.length?o.l0.push(l):l.l1.length||l.l22.length||l.l211.length||l.l22.length?o.l14.push(l):(l.l11.length||l.l2.length)&&o.l2.push(l),p.l0.length?o.l0.push(p):p.l1.length||p.l211.length||p.l22.length?o.l14.push(p):(p.l11.length||p.l2.length)&&o.l2.push(p),r.l0.length?o.l0.push(r):r.l1.length||r.l22.length||r.l211.length||r.l22.length?o.l14.push(r):(r.l11.length||r.l2.length)&&o.l2.push(r),g.l0.length?o.l0.push(g):g.l1.length||g.l22.length||g.l211.length||g.l22.length?o.l14.push(g):(g.l11.length||g.l2.length)&&o.l2.push(g),1==o.l14.length&&0==o.l2.length&&3==o.l0.length){if(o.l14[0].l1.length){var u=nm([o.l14[0].l1.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1,o.l0[2].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l14[0].l1[u[a][0]].c).concat(o.l0[0].l0[u[a][1]].c).concat(o.l0[1].l0[u[a][2]].c).concat(o.l0[2].l0[u[a][3]].c),y.l=y.l.concat(o.l14[0].l1[u[a][0]].l),n.push(y)}}if(o.l14[0].l22.length){var u=nm([o.l14[0].l22.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1,o.l0[2].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l14[0].l22[u[a][0]].c).concat(o.l0[0].l0[u[a][1]].c).concat(o.l0[1].l0[u[a][2]].c).concat(o.l0[2].l0[u[a][3]].c),y.l=y.l.concat(o.l14[0].l22[u[a][0]].l),y.p=y.p.concat(o.l14[0].l22[u[a][0]].p),n.push(y)}}if(o.l14[0].l211.length){var u=nm([o.l14[0].l211.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1,o.l0[2].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l14[0].l211[u[a][0]].c).concat(o.l0[0].l0[u[a][1]].c).concat(o.l0[1].l0[u[a][2]].c).concat(o.l0[2].l0[u[a][3]].c),y.l=y.l.concat(o.l14[0].l211[u[a][0]].l),y.p=y.p.concat(o.l14[0].l211[u[a][0]].p),n.push(y)}}}else if(0==o.l14.length&&2==o.l2.length&&2==o.l0.length){if(o.l2[0].l2.length&&o.l2[1].l2.length){var u=nm([o.l2[0].l2.length-1,o.l2[1].l2.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l2[0].l2[u[a][0]].c).concat(o.l2[1].l2[u[a][1]].c).concat(o.l0[0].l0[u[a][2]].c).concat(o.l0[1].l0[u[a][3]].c),y.l=y.l.concat(o.l2[0].l2[u[a][0]].l).concat(o.l2[1].l2[u[a][1]].l),y.p=y.p.concat(o.l2[0].l2[u[a][0]].p).concat(o.l2[1].l2[u[a][1]].p),n.push(y)}if(o.l2[0].l11.length){var u=nm([o.l2[0].l11.length-1,o.l2[1].l2.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l2[0].l11[u[a][0]].c).concat(o.l2[1].l2[u[a][1]].c).concat(o.l0[0].l0[u[a][2]].c).concat(o.l0[1].l0[u[a][3]].c),y.l=y.l.concat(o.l2[0].l11[u[a][0]].l).concat(o.l2[1].l2[u[a][1]].l),y.p=y.p.concat(o.l2[1].l2[u[a][1]].p),n.push(y)}}if(o.l2[1].l11.length){var u=nm([o.l2[0].l2.length-1,o.l2[1].l11.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l2[0].l2[u[a][0]].c).concat(o.l2[1].l11[u[a][1]].c).concat(o.l0[0].l0[u[a][2]].c).concat(o.l0[1].l0[u[a][3]].c),y.l=y.l.concat(o.l2[0].l2[u[a][0]].l).concat(o.l2[1].l11[u[a][1]].l),y.p=y.p.concat(o.l2[0].l2[u[a][0]].p),n.push(y)}}}else if(o.l2[0].l2.length&&o.l2[1].l11.length){var u=nm([o.l2[0].l2.length-1,o.l2[1].l11.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l2[0].l2[u[a][0]].c).concat(o.l2[1].l11[u[a][1]].c).concat(o.l0[0].l0[u[a][2]].c).concat(o.l0[1].l0[u[a][3]].c),y.l=y.l.concat(o.l2[0].l2[u[a][0]].l).concat(o.l2[1].l11[u[a][1]].l),y.p=y.p.concat(o.l2[0].l2[u[a][0]].p),n.push(y)}}else if(o.l2[0].l11.length&&o.l2[1].l2.length){var u=nm([o.l2[0].l11.length-1,o.l2[1].l2.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l2[0].l11[u[a][0]].c).concat(o.l2[1].l2[u[a][1]].c).concat(o.l0[0].l0[u[a][2]].c).concat(o.l0[1].l0[u[a][3]].c),y.l=y.l.concat(o.l2[0].l11[u[a][0]].l).concat(o.l2[1].l2[u[a][1]].l),y.p=y.p.concat(o.l2[1].l2[u[a][1]].p),n.push(y)}}}else if(0==o.l14.length&&1==o.l2.length&&3==o.l0.length){if(o.l2[0].l2.length){var u=nm([o.l2[0].l2.length-1,o.l0[0].l0.length-1,o.l0[1].l0.length-1,o.l0[2].l0.length-1]);for(a=0;a<u.length;a++){var y={c:[],p:[],l:[],h:c};y.c=y.c.concat(o.l2[0].l2[u[a][0]].c).concat(o.l0[0].l0[u[a][1]].c).concat(o.l0[1].l0[u[a][2]].c).concat(o.l0[2].l0[u[a][3]].c),y.l=y.l.concat(o.l2[0].l2[u[a][0]].l),y.p=y.p.concat(o.l2[0].l2[u[a][0]].p),n.push(y)}}}else if(1==c.g.length&&3==c.l.length){var y={c:[],p:[],l:e.filter(function(e){return 50>e}),h:c};n.push(y)}return n}function listenChance(e){for(var t=[],l=[],p=[],r=0;r<e.length;r++){var g=e[r].p.slice(),c=e[r].l.slice().sort(function(e,t){return e-t}),n=c.length+2*g.length;if(4==n?2==g.length?(t.push({lc:[g[0][0],g[1][0]],type:5}),l.push(g[0][0]),l.push(g[1][0])):1==g.length&&(c[1]-c[0]==2?(t.push({lc:[c[0]+1],type:2}),l.push(c[0]+1)):c[1]-c[0]==1&&(card_types[c[0]].edge?(t.push({lc:[c[1]+1],type:3}),l.push(c[1]+1)):card_types[c[1]].edge?(t.push({lc:[c[0]-1],type:3}),l.push(c[0]-1)):(t.push({lc:[c[0]-1,c[1]+1],type:4}),l.push(c[0]-1),l.push(c[1]+1)))):1==n&&(t.push({lc:[c[0]],type:1}),l.push(c[0])),!p.length&&(1!=g.length||2!=n)&&1==e[r].h.g.length&&3==e[r].h.l.length)for(var a=e[r].h.g[0].concat(e[r].h.l).sort(function(e,t){return e-t}),o=0;8>o;o++)if(a[o]!=o+51){t.push({lc:[o+51],type:7}),p.push(o+51);break}}for(l.sort(function(e,t){return e-t}),p.length&&l.push(p[0]),r=0;r<l.length;r++)l[r+1]==l[r]&&(l.splice(r+1,1),r--);return{chances:l,types:t}}function cardsToGroup(e){var t,l=e.slice().sort(function(e,t){return e-t});e:for(var p=0;p<groups.length;p++){t=groups[p].cards;for(var r=t.length-1;r>=0;r--)if(l[r]!=t[r])continue e;return groups[p].type}}function groupType(e){for(var t,l=[],p=0;p<e.c.length;p++)t=group_types[cardsToGroup(e.c[p])],t&&l.push(t);return l}function countPoint(){}var cards=[{type:11,name:"一萬",edge:!0},{type:12,name:"二萬",edge:!1},{type:13,name:"三萬",edge:!1},{type:14,name:"四萬",edge:!1},{type:15,name:"五萬",edge:!1},{type:16,name:"六萬",edge:!1},{type:17,name:"七萬",edge:!1},{type:18,name:"八萬",edge:!1},{type:19,name:"九萬",edge:!0},{type:21,name:"一筒",edge:!0},{type:22,name:"二筒",edge:!1},{type:23,name:"三筒",edge:!1},{type:24,name:"四筒",edge:!1},{type:25,name:"五筒",edge:!1},{type:26,name:"六筒",edge:!1},{type:27,name:"七筒",edge:!1},{type:28,name:"八筒",edge:!1},{type:29,name:"九筒",edge:!0},{type:31,name:"一條",edge:!0},{type:32,name:"二條",edge:!1},{type:33,name:"三條",edge:!1},{type:34,name:"四條",edge:!1},{type:35,name:"五條",edge:!1},{type:36,name:"六條",edge:!1},{type:37,name:"七條",edge:!1},{type:38,name:"八條",edge:!1},{type:39,name:"九條",edge:!0},{type:41,name:"東",edge:!0},{type:42,name:"南",edge:!0},{type:43,name:"西",edge:!0},{type:44,name:"北",edge:!0},{type:45,name:"中",edge:!0},{type:46,name:"發",edge:!0},{type:47,name:"白",edge:!0},{type:51,name:"春"},{type:52,name:"夏"},{type:53,name:"秋"},{type:54,name:"冬"},{type:55,name:"梅"},{type:56,name:"蘭"},{type:57,name:"竹"},{type:58,name:"菊"}],card_types={},groups=[{type:1,group_type:0,cards:[11,12,13],edge:!0},{type:2,group_type:0,cards:[12,13,14],edge:!1},{type:3,group_type:0,cards:[13,14,15],edge:!1},{type:4,group_type:0,cards:[14,15,16],edge:!1},{type:5,group_type:0,cards:[15,16,17],edge:!1},{type:6,group_type:0,cards:[16,17,18],edge:!1},{type:7,group_type:0,cards:[17,18,19],edge:!0},{type:8,group_type:1,cards:[11,11,11],edge:!0},{type:9,group_type:1,cards:[12,12,12],edge:!1},{type:10,group_type:1,cards:[13,13,13],edge:!1},{type:11,group_type:1,cards:[14,14,14],edge:!1},{type:12,group_type:1,cards:[15,15,15],edge:!1},{type:13,group_type:1,cards:[16,16,16],edge:!1},{type:14,group_type:1,cards:[17,17,17],edge:!1},{type:15,group_type:1,cards:[18,18,18],edge:!1},{type:16,group_type:1,cards:[19,19,19],edge:!0},{type:17,group_type:2,cards:[11,11,11,11],edge:!0},{type:18,group_type:2,cards:[12,12,12,12],edge:!1},{type:19,group_type:2,cards:[13,13,13,13],edge:!1},{type:20,group_type:2,cards:[14,14,14,14],edge:!1},{type:21,group_type:2,cards:[15,15,15,15],edge:!1},{type:22,group_type:2,cards:[16,16,16,16],edge:!1},{type:23,group_type:2,cards:[17,17,17,17],edge:!1},{type:24,group_type:2,cards:[18,18,18,18],edge:!1},{type:25,group_type:2,cards:[19,19,19,19],edge:!0},{type:26,group_type:0,cards:[21,22,23],edge:!0},{type:27,group_type:0,cards:[22,23,24],edge:!1},{type:28,group_type:0,cards:[23,24,25],edge:!1},{type:29,group_type:0,cards:[24,25,26],edge:!1},{type:30,group_type:0,cards:[25,26,27],edge:!1},{type:31,group_type:0,cards:[26,27,28],edge:!1},{type:32,group_type:0,cards:[27,28,29],edge:!1},{type:33,group_type:1,cards:[21,21,21],edge:!1},{type:34,group_type:1,cards:[22,22,22],edge:!1},{type:35,group_type:1,cards:[23,23,23],edge:!1},{type:36,group_type:1,cards:[24,24,24],edge:!1},{type:37,group_type:1,cards:[25,25,25],edge:!1},{type:38,group_type:1,cards:[26,26,26],edge:!1},{type:39,group_type:1,cards:[27,27,27],edge:!1},{type:40,group_type:1,cards:[28,28,28],edge:!1},{type:41,group_type:1,cards:[29,29,29],edge:!0},{type:42,group_type:2,cards:[21,21,21,21],edge:!0},{type:43,group_type:2,cards:[22,22,22,22],edge:!1},{type:44,group_type:2,cards:[23,23,23,23],edge:!1},{type:45,group_type:2,cards:[24,24,24,24],edge:!1},{type:46,group_type:2,cards:[25,25,25,25],edge:!1},{type:47,group_type:2,cards:[26,26,26,26],edge:!1},{type:48,group_type:2,cards:[27,27,27,27],edge:!1},{type:49,group_type:2,cards:[28,28,28,28],edge:!1},{type:50,group_type:2,cards:[29,29,29,29],edge:!0},{type:51,group_type:0,cards:[31,32,33],edge:!0},{type:52,group_type:0,cards:[32,33,34],edge:!1},{type:53,group_type:0,cards:[33,34,35],edge:!1},{type:54,group_type:0,cards:[34,35,36],edge:!1},{type:55,group_type:0,cards:[35,36,37],edge:!1},{type:56,group_type:0,cards:[36,37,38],edge:!1},{type:57,group_type:0,cards:[37,38,39],edge:!0},{type:58,group_type:1,cards:[31,31,31],edge:!0},{type:59,group_type:1,cards:[32,32,32],edge:!1},{type:60,group_type:1,cards:[33,33,33],edge:!1},{type:61,group_type:1,cards:[34,34,34],edge:!1},{type:62,group_type:1,cards:[35,35,35],edge:!1},{type:63,group_type:1,cards:[36,36,36],edge:!1},{type:64,group_type:1,cards:[37,37,37],edge:!1},{type:65,group_type:1,cards:[38,38,38],edge:!1},{type:66,group_type:1,cards:[39,39,39],edge:!0},{type:67,group_type:2,cards:[31,31,31,31],edge:!0},{type:68,group_type:2,cards:[32,32,32,32],edge:!1},{type:69,group_type:2,cards:[33,33,33,33],edge:!1},{type:70,group_type:2,cards:[34,34,34,34],edge:!1},{type:71,group_type:2,cards:[35,35,35,35],edge:!1},{type:72,group_type:2,cards:[36,36,36,36],edge:!1},{type:73,group_type:2,cards:[37,37,37,37],edge:!1},{type:74,group_type:2,cards:[38,38,38,38],edge:!1},{type:75,group_type:2,cards:[39,39,39,39],edge:!0},{type:76,group_type:1,cards:[41,41,41],edge:!0},{type:77,group_type:1,cards:[42,42,42],edge:!0},{type:78,group_type:1,cards:[43,43,43],edge:!0},{type:79,group_type:1,cards:[44,44,44],edge:!0},{type:80,group_type:1,cards:[45,45,45],edge:!0},{type:81,group_type:1,cards:[46,46,46],edge:!0},{type:82,group_type:1,cards:[47,47,47],edge:!0},{type:83,group_type:2,cards:[41,41,41,41],edge:!0},{type:84,group_type:2,cards:[42,42,42,42],edge:!0},{type:85,group_type:2,cards:[43,43,43,43],edge:!0},{type:86,group_type:2,cards:[44,44,44,44],edge:!0},{type:87,group_type:2,cards:[45,45,45,45],edge:!0},{type:88,group_type:2,cards:[46,46,46,46],edge:!0},{type:89,group_type:2,cards:[47,47,47,47],edge:!0},{type:90,group_type:3,cards:[51],edge:!1},{type:91,group_type:3,cards:[52],edge:!1},{type:92,group_type:3,cards:[53],edge:!1},{type:93,group_type:3,cards:[54],edge:!1},{type:94,group_type:3,cards:[55],edge:!1},{type:95,group_type:3,cards:[56],edge:!1},{type:96,group_type:3,cards:[57],edge:!1},{type:97,group_type:3,cards:[58],edge:!1},{type:98,group_type:3,cards:[51,52,53,54],edge:!1},{type:99,group_type:3,cards:[55,56,57,58],edge:!1}],group_types={},points=[],point_types={};cardGroupSetup();